#+title: RAID

- Copy disk partition information
: sfdisk -d /dev/sdb | sfdisk /dev/sda

- Scan disks
: echo "- - -" > /sys/class/scsi_host/host0/scan

- Add disk to raid
: mdadm /dev/md0 --add /dev/sda1

: partprobe /dev/sdd
: mount | grep sdd
: mdadm /dev/md127 --fail /dev/sdd1
: mdadm /dev/md0 --fail /dev/sda1
: mdadm /dev/md0 --remove /dev/sda1

- Disconnect disk
: echo 1 > /sys/block/sda/device/delete

- for i in {1..8}; do smartctl -a /dev/sg$i; done
- [[https://blog.tinned-software.net/replace-hard-disk-from-software-raid/][Replace hard disk from software RAID - Experiencing Technology]]
- # mdadm --create --verbose --level=5 --metadata=1.2 --chunk=256 --raid-devices=4 /dev/md/md0 /dev/sdb1 /dev/sdc1 /dev/sdd1 /dev/sde1
  note that could use devices derictly

- create raid 1 with missing disk
: mdadm --create --verbose --level=1 --metadata=1.2 --raid-devices=2 /dev/md/1 /dev/sda1 missing

* [[https://unix.stackexchange.com/questions/190264/disassemble-a-raid-1-arragement-without-removing-reinstalling-the-system][Disassemble a RAID 1 arragement without removing/reinstalling the system - Unix & Linux Stack Exchange]]
Just fail and remove one of your drives:

  mdadm /dev/md0 --fail /dev/sdb --remove /dev/sdb

After that change your /etc/fstab to use the drive left in RAID.

Reboot. And then destroy your RAID:

  mdadm /dev/md0 --destroy

: kubectl create deployment nginx --image=nginx
: kubectl expose deployment nginx --port=80

#+begin_src yaml
  apiVersion: networking.k8s.io/v1
  kind: NetworkPolicy
  metadata:
    name: access-nginx
  spec:
    podSelector:
      matchLabels:
        app: nginx
    ingress:
    - from:
      - podSelector:
          matchLabels:
            access: "true"
#+end_src

* Learning
- [[https://nicovibert.com/2022/07/21/bgp-with-cilium/][BGP with Cilium]]
- [[https://isovalent.com/blog/post/cilium-release-112/#ingress][Cilium 1.12 - Ingress, Multi-Cluster, Service Mesh, External Workloads, ...]]
- [[https://isovalent.com/data/multi-cluster-ebook.pdf][multi-cluster-ebook.pdf]]
- [[https://cilium.io/blog/2019/03/12/clustermesh/][Deep Dive into Cilium Multi-cluster]]
- [[https://docs.cilium.io/en/stable/gettingstarted/clustermesh/clustermesh/][Setting up Cluster Mesh â€” Cilium 1.12.4 documentation]]

* Debug

1. LB IP is assigned to the service (kubectl get svc).
2. Cilium has properly provisioned services (cilium bpf lb list).
3. What happens with a request (cilium monitor).

* Tools
- [[https://editor.cilium.io/?id=sGIKib2OwOtkkypE][Network Policy Editor for Kubernetes]]
- [[https://jenkins.cilium.io/][Cilium Jenkins Instance]]

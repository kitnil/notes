Введение
========

Управление конфигурации является очень важным процессом, который находится на
стыке между разработкой и администрированием.

Решаемые задачи управлением конфигурациями достаточно широки.

Они включают в себя на стройку серверной инфаструктуры, причем это не
обязательно какая-то инфаструктура из серверов на которую нужно зайти и
поставить на них определенный софт

Это в том числе и настройка облачной инфраструктуры, особенно учитывая в
последнее время распространение облаков

Это например amazon, google cloud, на которых, перед тем как собственно настраивать
сервера, вам сначала нужно их создать.

Решаемые задачи
===============

* Настройка облачной инфаструктуры
* Настройка серверной инфраструктуры
* Настройка локальной среды для разработки
* Деплой

Делается это обычно в визуальном интерфейсе, когда вы натыкиваете какие-то
параметры, у вас веб балансеры, сервера, почта и много много другое.

Соответственно системы управления конфигурациями позволяют это автоматизировать
и воспроизводить, то есть то что вы настроете один раз, вы потом сможете
использовать многократно.

Естественно стандартная история, с которой начиналась управление конфигурациями
это обычно серверная инфоструктура, на который вам нужно накатывать какой-то
софт, обновлять его, и вообще следить за тем как все работает и происходит.

Кроме этого управление конфигурациями нужны и для локальной среды, для того
чтобы развернуть все что нужно для разработки.

Это довольно очередо и не всегда просто.

Очень часты ситуации, когда человек приходит в компанию, он тратит три дня.

И ему выделяют три дня на то, чтобы он развернул приложения.

При этом скорее всего нет README о том, как это сделать.

А если оно и есть, то оно устаревает.

Потому что вообщем то любая документация всегда устаревает

Особенно та которая не пользуется внешним спросом, а используется только внутри
команды.

И это не очень приятно, когда приходится постоянно это делать.

Обычно такие люди пытаются как раз что то изменить, но потом когда они в конце
концов, это забывается.

И все повторяется снова с приходом нового человека.

Кроме этого локальная среда все же должна максимально соответствовать production
среде.

И было бы очень здорово, если бы одна и та же настройка, могла работать и там и
там, и не пришлось бы их независимо описывать и независимом настривать.

Кроме этого деплой (выкладка кода на production), или может быть на staging, это
в общем то тоже процесс, который является частью управления конфигурациями.

Потому что по сути это обновление серверного программного обеспечения.

Только здесь уже программое обеспечение - это то, что вы уже сами
непосредственно разрарабатываете.

Не все системы управления конфигурациями позволяют это делать удобно, но Ansible
позволяет это делать достаточно хорошо, и вообще есть тенденция, эмиграция
специализированных инструментов, которые существуют в конкретных языках
программирования на Ansible

Потому что-то этот способ является более универсальным и особенно он хорош,
когда у вас гитрогенная среда с различными сервисами на разных языках и
совершенно разными стэками.

То есть например Java, Ruby, и так далее.

Когда они между собой слабо пересекаются, но при этом присутствует у вас в одной
экосистеме машин.

Решение в лоб
=============

* Ручное конфигурирование
* Исправления прямо на целевых машинах
* Написание bash скриптов

Какие решения можно придумать влоб для решения предыдущих задач?

Что можно сделать, и как это общем то изначально делать

Первый это ручное конфигурирование, когда вы просто по необходимости делайте
правки, которые вам нужны.

Кроме того что они делаются руками, они еще и делаются чаще всего на целевых
машинах.

То есть вы просто заходите и прям там делаете конфигурации Nginx, перезапуск и
так далее.

Что естественно видет к большому количеству проблем.

Более продвинуты способ, но тоже обладающий почти всеми теми же недостатками,
это написание своих собственных bash скриптов.

Так тоже можно делать, так тоже многие делают.

Особенно старые админы, которые где-то долго работают на одном месте, у них с
собой есть целая пачка скриптов, которые они переиспользуют и держат обычно в
секрете от всех остальных.

Проблемы
========

Но все эти подходы имеют большие недостатки.

Во первых, при таком подходе, когда все делается руками, все сервера немного
разные.

Потому что если у вас существуют какая-то экосистема, где более одного сервера,
то делать синхронные изменения и контролировать, то что они выполняються
одноврменно везде достаточно сложно.

В любом случае кто-нибудь случайно зайдет и поменяет где-нибудь в одном месте,
забыв синхронизировать это с другим местом.

Это можно пытаться контролировать, но все будет упираться в человеческий фактор.

В конце концов они все равно будут расходиться, что стопроцентно будет приводить
проблемам.

Второй момент крайне важный, то что очень сложно воспроизвести конфигурацию.

То есть если у вас ложится по какой причине машина, то поднять ее будет может
быть даже невозможно, в таком же виде, в котором она была.

Потому что ее конфигурация, настройка софта, может быть раскина по всей файловой
структуре.
 
И очень сложно вспомнить, и вообще это неправильно, пытаться вспомнить, что там
такое было.
 
Есть случаи когда люди, вместо того чтобы достаточно быстро, в течение 20 минут,
что позволяют современные средства виртуализации, поднять новую виртуальную
машину, тратят много суток, на то, чтобы вспомнить все настройки, отладить их
снова и запустить.

И плавно мы приходим соответственно к следующему пункту, нет контроля изменений,
то есть вы даже не сможете понять, что пошло не так.

Если кто то где то что-то поменял, например сработала система мониторинга
алертов, что-то не работает, то чтобы воспроизвести ситуацию, вам придется всех,
кто мог что-то менять, поднимать на уши, спрашивать, и всем вместе пытаться
впомнить что же произошло.

Это довольно грустно.

Ну и последнее в этом списке, но не последняя среди проблем это знание хранятся
в головах, и обычно в одной.

Кто-то конкретно знает, как это делать.

Все стараются делать изменение через него.

Или этот человеческ пытаюется отконтролировать.

Соответственно все концентрируются вокруг небольшой группы людей или одного
человека.

Сответствено, если они увольняются, или происходят какие-то изменения, то это
приводит к проблемам.

Потому что нет никакой прозрачной схемы.

Ну и вообще это очень часто отделяет программиста от админа дальше, вместо того,
чтобы их наооборот сближать и делать одной командой.

Управление конфигурацией
========================

* Описание в одном месте
* Инфраструктура как код
* Идемпотентность

Автоматическое управление конфигурациями решает большинство этих проблем.

Вот какими способоми.

Вопервых вы описываете все в одном месте.

Ваши конфигурации не разбросаны где-то по серверам, а это будет какой-то
репозиторий, в котором лежит код, описание.

Вы в любой момент видите, что у вас было, в какой момент, и что сейчас находится
на сервере.
 
Второй пункт это инфраструктура как код, это очень важный аспект, означающий,
что теперь вы не производите вообще никаких изменений руками.
 
Вы пишете код, который потом с помощью специальных систем применяется.

И таким образом ваши конфигурации эволюционируют, но по факту вы пишите код.

вольт санирует но по факту вы
пишете корт и от этого вы получаете все преимущества которые существуют то в
системах контроля персика скот можем держать в нато вы можете видеть и вы видите
что будет если м чтобы его то есть какие то изменения и любой изменения приводят
к тому что всем любой момент могут легко понять что происходит стресс напрямую
через поры крест разрабатывать и таким образом контролировать изменена серверах
но и множество других очень клевых фишек открывается с петером когда начинать
использовать инфраструктуру как котов а есть ясно в таком случае поднять новый
сервер становится тривиальная задача потому что вот у нас вас ваши конфигурация
вы просто я накатывается и все работает после этого вернуться к обратному
впрочем конфигурирования просто невозможно потому что это настолько хорошо
насколько удобно что люди которых опознали сложно представить что может как то
по другому есть еще один последний элемент в этом списке но не последний по
важности этой депутата что это означает повторный запуск настройки конфигурации
необходим системе конфигурации которым за сделать изменению ваш серверах не
приводят крышу если вы попытаетесь написать например барской которые
устанавливать софт делать какие то изменения то большое количество команд в нем
не является дым поток например создание директорий процент создание семенников
еще множество других команд тот что это означает повторное выполнения такова на
прилет к сбою в соответствии с его пишете баскет и вам придется руками все это
разруливать еде вовсе необходимые проверки и водка один из самых злых факторов
который я создает не поддерживаемые сложные скрипты который достаточно сложный
200 до рабочего состояния к счастью систем про интеграции декларируют и
достаточность как одну из своих главных фишек и они берут я почти полностью на
себя естественно не все ситуации можно погрузить легко в больше степени они за
вас решают эту проблему

что есть ключевого vn слова потому что правление
конфигурации это общая история но кс ущерб множество различных систем и вот на
текущий момент за собой является одной из самых приятных всем использования
особенно те кто работал статьи монстрами как шеф упадка у которых свои конечно
есть сильно напрямую что они хорошо работать на большее их роль в системах но
простота и удобство использования осыпал конечно привлекает все больше и больше
как разработчиков так администратор во первых для работы с обвала цен нужно
только установленной пенса было у вас даты машин из которого делаете все
изменения очищает локально маш машина для разработки так вот когда я свой идет
на другую машину чтобы выполнить там команды ему ничего не нужно кроме саsa жж
вам не нужно ничего стать то другим машинам вам например агенты как нужно в
случае шефа или во вторых ооо это собой отмечается от многих других систем тем
что у него используются декларативно описание состояние машины то есть вы не
используйте кокойты язык конкретны если мы опять же берем шефа поэтому вы
описываете там состоянии машина языке руды чтобы первых не для всех удобно с
одной стороны а во вторых у вас полноценный тюрем в полной язык за что приводит
хорош совершенно не поддержим коми очень часто потому что например администратор
не всегда программисты плюс мы полностью будут действий может сыграть с вами
злую шутку да конечно когда у вас есть как пограничная описание вы не всегда
легко можете выразить что что не задумывалась но для 90 процентах случаев
стандартных задач это намного удобнее потому что сбу фото ap единообразие полной
на всех уровнях мы плюс никакого иска программируется достаточно просто а суду
чьи то что я мог файлы очень распространенный понятные формат для всех общем то
кто хоть как то с разработкой сталкиваться кроме того особо отличается других
систем тем что они из коробки предоставляют гигантское количество модулей этих
модулей сотни и они покрывают все это не только базовые настройки прокат рациона
системы которые являются общими для всех он сам был сразу умеет работать зато
терроризма замен данных системы мониторинга обертиллиах вокальный и все все все
что только можно вообразить поэтому используя садовый просто сразу можете начать
с себя делать все что вам нужно нет без попытки искать какие то дополнений для
того чтобы завести даже каких простейшие задачи но и последние списке ii из
ключевых особенностей осыпал это для кого то что с ним очень легко начать в
отличие пиджак многих других систем которые требуют для своих первичных
конфигураций огромных количеств рабов и через который кстати говоря многие
вообще пройти дожди могут просто потому что их это останавливает кто пенса был в
своем базовом варианте можно чуть использовать не создавая вообще ни одного
файла это подкупает очень сильно и это действительно позволяет очень легко войти
в него то есть сила вам не нужно знать очень много и очень глубоко эту систему
для того чтобы начать использовать более того на так называемый по иконке эта
тема файлов которых описывается конфигурация они очень сильно похоже на то же
самый больший кредит который был бы написали да это я молод не башко нечто но
структура будет очень похожи при этом в эту часть эти плюшки которых мы говорили
и не будет создан никакого дополнительного артек никакие 20 файлов никакой
дополнительной предустановки которое требовалось бы с более сложными системами
поэтому пьеса был а это не та система которую нужно начинать использовать если у
ваших количество серверов при превышает 10 штук я забыл настолько просто
настолько удобен что ему надо использовать даже если бы один их даже если вы
работаете просто на локальной машине ваз даже нет продакшн потому что настройка
собственно вокальной среды это уже проблема которую можно решить полностью и
целиком с помощью авиации что касается текущего курса тесты проверяющие то как
вы выполняйте задачи что общая цена описана самым и освоил те кто же здорово то
что смыл хорошо подходит для того чтобы верифицировать то что делается им самим
же то есть он может легко его модуля легко позволяет проверять состояние системы
текущей теракт собой страны это очень удобно другой страны и есть определенные
особенности том что запуская часто вы будете видеть вывод раз облом иногда может
быть достаточно гербов 100 есть подробный а поэтому в нем нужно выискивать где
написано об ошибке но и соответственно будет вам помогать понимать я сам был уже
потому что вы будете постоянно видеть новый год

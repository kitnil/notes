:PROPERTIES:
:ID:       ecfb0349-6e40-4259-ba36-9e0552ec5c77
:END:
#+title: MacOS

- [[https://github.com/fastai/fastmac][fastai/fastmac: Get a MacOS or Linux shell, for free, in around 2 minutes]]
- [[https://github.com/luin/medis][luin/medis: üíª Medis is a beautiful, easy-to-use Mac database management application for Redis.]]
- [[https://tunnelblick.net/][Tunnelblick | Free open source OpenVPN VPN client server software for macOS]]
- [[https://github.com/kholia/OSX-KVM][kholia/OSX-KVM: Run macOS on QEMU/KVM. With OpenCore + Big Sur + Monterey support now! Only commercial (paid) support is available now to avoid spammy issues. No Mac system is required.]]
- [[https://serveradmin.ru/ustanovka-macos-v-proxmox/][–£—Å—Ç–∞–Ω–æ–≤–∫–∞ macOS –≤ Proxmox ‚Äî Server Admin]]
- [[https://github.com/quyse/coil-toolchain-macos][quyse/coil-toolchain-macos: macOS VMs with Nix on Linux]]
- [[https://github.com/m1k1o/osx-in-docker][m1k1o/osx-in-docker: Run OSX inside Docker, connect via VNC - lightweight repository.]]
- [[https://github.com/TrungNguyen1909/qemu-t8030][TrungNguyen1909/qemu-t8030: iPhone 11 emulated on QEMU]]
- [[https://github.com/johncolby/macOS-KVM][johncolby/macOS-KVM: Streamlined macOS QEMU KVM Hackintosh configuration using OpenCore and libvirt]]
- [[https://github.com/taylorcoffelt/macos-docker][taylorcoffelt/macos-docker: Runs a macOS image on QEMU in a docker container, with VNC, SSH and SPICE access]]
- [[https://github.com/0xf4b1/qemu-kvm-macos][0xf4b1/qemu-kvm-macos: QEMU/KVM setup with GPU passthrough for MacOS on an Arch Linux host]]
- [[https://github.com/CloverHackyColor/CloverBootloader][CloverHackyColor/CloverBootloader: Bootloader for macOS, Windows and Linux in UEFI and in legacy mode]]
- [[https://github.com/rbreaves/kinto][rbreaves/kinto: Mac-style shortcut keys for Linux & Windows.]]
- [[https://github.com/macbian-linux/macos-subsystem-for-linux][macbian-linux/macos-subsystem-for-linux: Guide on how to use Qemu to create a similar effect to Windows Subsystem for Linux on macOS. Unfinished; contributions are welcome!]]
- [[https://github.com/srsholmes/yal][srsholmes/yal: Yet Another Launcher]]
- [[https://github.com/r0man/asahi-guix][r0man/asahi-guix: Asahi Linux on GNU Guix]]

* [[https://www.tune-it.ru/web/ifsolo/blog/-/blogs/osx-v-qemu-kvm-s-gpu-passthrough?_com_liferay_blogs_web_portlet_BlogsPortlet_redirect=https%3A%2F%2Fwww.tune-it.ru%2Fweb%2Fifsolo%2Fblog%3Fp_p_id%3Dcom_liferay_blogs_web_portlet_BlogsPortlet%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26_com_liferay_blogs_web_portlet_BlogsPortlet_mvcRenderCommandName%3D%252Fblogs%252Fview%26_com_liferay_blogs_web_portlet_BlogsPortlet_mvcRenderCommandName%3D%252Fblogs%252Fview%26_com_liferay_blogs_web_portlet_BlogsPortlet_cur%3D1%26_com_liferay_blogs_web_portlet_BlogsPortlet_delta%3D20][OSx –≤ QEMU/KVM —Å GPU-passthrough - –ë–ª–æ–≥ - Tune IT]]

OSx –≤ QEMU/KVM —Å GPU-passthrough
17 –∏—é–Ω—è 2022 0 –ò –ì–æ—Ä—å

Operating System: Linux Mint 20.3
Kernel: Linux 5.14.0-1042-oem
?
~$ /usr/bin/qemu-system-x86_64 --version
QEMU emulator version 4.2.1 (Debian 1:4.2-3ubuntu6.21)

GPU: Sapphire Radeon RX 570

–°—Ç–∞–≤–∏–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–∫–µ—Ç—ã:
?
sudo apt udpate && sudo apt install git qemu-system qemu-utils python3 python3-pip -y

–í–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è "macOS-Simple-KVM" - –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –Ω—É–∂–Ω–æ–≥–æ –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–∞ OSx –¥–ª—è KVM —Å –∑–∞–≥—Ä—É–∑—á–∏–∫–æ–º Clover.
?
git clone https://github.com/foxlet/macOS-Simple-KVM.git
./jumpstart.sh --mojave <strong>(–ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç —Å–ª–µ–¥—É—é—â–∏–µ –∫–ª—é—á–∏ –¥–ª—è –≤–µ—Ä—Å–∏–π OSx: --high-sierra, --mojave, --catalina)</strong>

–°–æ–∑–¥–∞—ë–º –¥–∏—Å–∫:
?
qemu-img create -f qcow2 osx.qcow2 128G

–í —Å–∫—Ä–∏–ø—Ç basic.sh –æ—Ç "macOS-Simple-KVM", –¥–æ–±–∞–≤–ª—è–µ–º —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç—Ä–æ—á–∫–∏:
?
-drive id=SystemDisk,if=none,file=osx.qcow2 \
-device ide-hd,bus=sata.4,drive=SystemDisk \

–ó–∞–ø—É—Å–∫–∞–µ–º basic.sh
?
./basic.sh

–ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –ø–æ VNC (port: 5900) –∫ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ –∏ –≤—ã–±–∏—Ä–∞–µ–º –≤ Clover:

‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã

–í—ã–±–∏—Ä–∞–µ–º Disk Utility –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º External –¥–∏—Å–∫ –≤ APFS, –ø–æ—Å–ª–µ —á–µ–≥–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –≤—ã–±–∏—Ä–∞–µ–º Reinstall macOS.

–û–∂–∏–¥–∞–µ–º –æ–∫–æ–Ω—á–∞–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Å–∏—Å—Ç–µ–º—É –Ω–∞ —Å—Ç–∞—Ä—Ç–µ.
‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚ÄãGPU-passthrough

–í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö BIOS/UEFI –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–∫–ª—é—á–∏—Ç—å VT-d (Intel CPU) –∏–ª–∏ AMD Vi (AMD CPU).

–ü–æ–ª—É—á–∞–µ–º id –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã:
?
lspci -nn | grep "VGA\|Audio"

–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
?
26:00.0 VGA compatible controller [0300]: Advanced Micro Devices, Inc. [AMD/ATI] Curacao XT / Trinidad XT [Radeon R7 370 / R9 270X/370X] [1002:6810]
26:00.1 Audio device [0403]: Advanced Micro Devices, Inc. [AMD/ATI] Oland/Hainan/Cape Verde/Pitcairn HDMI Audio [Radeon HD 7000 Series] [1002:aab0]

–ì–¥–µ ‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã[1002:6810] –∏ [1002:aab0] - GPU id.

–í–∫–ª—é—á–∞–µ–º GPU –≤ IOMMU –≥—Ä—É–ø–ø—É —Ä–µ–¥–∞–∫—Ç–∏—Ä—É—è /etc/default/grub:

–î–ª—è AMD:
?
GRUB_CMDLINE_LINUX_DEFAULT="amd_iommu=on iommu=pt"

‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã–î–ª—è Intel:‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã
?
GRUB_CMDLINE_LINUX_DEFAULT="intel_iommu=on"

–î–æ–±–∞–≤–ª—è–µ–º GPU —Å –Ω—É–∂–Ω—ã–º–∏ id:
?
GRUB_CMDLINE_LINUX_DEFAULT="amd_iommu=on iommu=pt kvm.ignore_msrs=1 vfio-pci.ids=1002:6810,1002:aab0"
 
sudo update-grub

–í —Ä–∞–Ω–µ–µ —Ä–µ–¥–∞–∫—Ç–∏—É—Ä–µ–º—ã–π basic.sh, –¥–æ–±–∞–≤–ª—è–µ–º:
?
-vga none \
  -device pcie-root-port,bus=pcie.0,multifunction=on,port=1,chassis=1,id=port.1 \
  -device vfio-pci,host=26:00.0,bus=port.1,multifunction=on,romfile=/path/to/card.rom \
  -device vfio-pci,host=26:00.1,bus=port.1 \

–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É —Å OSx –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ GPU.

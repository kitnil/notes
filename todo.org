
* TODO Replace Zabbix web interface with alerta
  SCHEDULED: <2020-03-08 Sun>
* TODO Add docker alias
  SCHEDULED: <2020-03-19 Thu>
  #+BEGIN_SRC bash
    for service in $(docker service ls -q); do
      docker service inspect --format \
         '{{.Spec.Name}}: {{range .Endpoint.VirtualIPs}}{{.Addr}} {{end}}' \
         ${service}
    done
  #+END_SRC
* TODO Xorg keyboard layout
  SCHEDULED: <2020-03-18 Wed>
#+begin_example
  Section "InputClass"
    Identifier "Keyboard catchall"
    MatchIsKeyboard "on"
    Option "XkbModel" "pc104"
    Option "XkbLayout" "us,ru"
    Option "XkbOptions" "grp:menu_toggle,grp_led:scroll"
    Option "XkbVariant" ""
  EndSection
#+end_example
* TODO Parser Lebedeva /usr/lib/x86_64-linux-gnu/libmysqlclient.so.18
  SCHEDULED: <2020-01-20 Mon> DEADLINE: <2020-01-20 Mon>
* TODO MySQL upgrade
  SCHEDULED: <2020-01-31 Fri>
** mariadb docker run --restart unless-stopped
   SCHEDULED: <2020-04-13 Mon>

 2020-04-19 20:08:54 0 [ERROR] InnoDB: Downgrade after a crash is not supported. The redo log was created with MariaDB 10.4.12.
 2020-04-19 20:08:54 0 [ERROR] InnoDB: Plugin initialization aborted with error Generic error

 https://www.percona.com/blog/2013/09/11/how-to-move-the-innodb-log-sequence-number-lsn-forward/
* TODO [[https://billing2.intr/vds/queue/item/257839][Freebsd Billing2 task]]
  SCHEDULED: <2020-01-20 Mon>
* TODO [[http://redmine.intr/issues/8833][Обновление MariaDB]]
  SCHEDULED: <2020-01-31 Fri>
* TODO NGINX Unit for NodeJS hosting
  SCHEDULED: <2020-01-24 Fri>
* TODO [[/home/oleg/src/gitlab.intr/Jenkinsfile]]
  SCHEDULED: <2020-01-26 Sun>
* TODO [[https://github.com/michaudg/godaddy-ddns/blob/master/godaddy.sh]]
  SCHEDULED: <2020-01-26 Sun>
* TODO Если размер базы больше чем 1.5 ГБ, то ее размер не учитывается. Пример b213062_test
  SCHEDULED: <2020-01-31 Fri>
* TODO [[https://fosdem.org/2020/schedule/events/][FOSDEM 2020 - Events]]
  SCHEDULED: <2020-02-09 Sun>
* TODO Fix configs in [[https://gitlab.intr/utils/ipmiview][ipmiview]] (need to symlink them)
  SCHEDULED: <2020-02-25 Tue>
* TODO Nixify Bitrix
  SCHEDULED: <2020-08-31 Mon>
* TODO Nixify PXE ~/majordomo/net/pxe/
  SCHEDULED: <2020-12-13 Sun>
* TODO debian9 $osVariant   = "debian8"; /ssh:kvm15.intr|sudo:root@kvm15.intr:/usr/local/repo/lib/kvm.pm
  SCHEDULED: <2020-02-05 Wed>
* TODO [[https://github.com/NixOS/nix/issues/2208][nix-shell dependencies can be garbage collected any time now / persistent nix-shell envs ?? Issue #2208 ?? NixOS/nix]]
  SCHEDULED: <2020-03-09 Mon>
* TODO [[https://kibana.intr/goto/5b656d4c6b23e85df3a38a9aeb9744e9][logstash te userid as field]]
  SCHEDULED: <2020-03-08 Sun>
* TODO Elastic save servers .bash_history
  SCHEDULED: <2020-03-31 Tue>
* TODO Shedule cron Jenkins jobs for projects in HMS group
  SCHEDULED: <2020-03-31 Tue>
* TODO [[https://grafana.com/docs/grafana/latest/administration/image_rendering/][Image rendering | Grafana Labs]]
  SCHEDULED: <2020-03-02 Mon>
* TODO [[https://github.com/abrander/phpfpmtop][abrander/phpfpmtop: A top like interface for PHP-FPM]]
  SCHEDULED: <2020-03-08 Sun>
* TODO Install [[https://github.com/raviqqe/muffet][raviqqe/muffet: Fast website link checker in Go]]
  SCHEDULED: <2020-03-11 Wed>
* TODO split git commit to a separate stage in awesome
  SCHEDULED: <2020-03-15 Sun>
* TODO session-environment-service-type /home/oleg/src/guix-master/gnu/system/pam.scm
  SCHEDULED: <2020-03-15 Sun>
* TODO https://travis-ci.org/github/mkoppanen/imagick/jobs/527363899/config
  SCHEDULED: <2020-03-31 Tue>
* TODO Switch to python test in Majordomo nixpkgs
  SCHEDULED: <2020-09-01 Tue>
#+begin_example
      start_all()
      server.wait_for_unit("mysql");
      server.wait_for_unit("nginx");
      sleep(5);
      assert "This file is part of nginx" in succeed(
          "curl --fail --header 'example.com' 127.0.0.1/index.php"
      )
#+end_example
* TODO [[https://cerberus.intr/index.php/profiles/ticket/EZ-75759-736/conversation/read_all][Mail notification in sieve]]
  SCHEDULED: <2021-08-02 Mon>
  https://www.rfc-editor.org/rfc/rfc5436.html
* TODO Add PHP update notification [[/home/oleg/archive/src/tmp/php-versions.org][script]]
  SCHEDULED: <2020-03-23 Mon>
  #+BEGIN_SRC bash
    for version in $(curl --silent 'https://news-web.php.net/group.php?group=php.announce&format=rss' | xq --raw-output '.rss.channel.item[] | .title' | awk '/Released/ { print $2 }'); do echo curl --request POST "https://alerta.intr/api/alert" --header "Authorization: Key xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" --header "Content-type: application/json" -d "{\"resource\": \"ci\", \"event\": \"php.version.$version\", \"environment\": \"Production\", \"severity\": \"info\", \"correlate\": [], \"service\": [\"webservices\"], \"group\": null, \"value\": \"$version\", \"text\": \"New PHP $version release\", \"tags\": [], \"attributes\": {}, \"origin\": null, \"type\": null, \"timeout\": 691200, \"rawData\": null, \"customer\": null}"; done
  #+END_SRC
* TODO Add .s6-svscan/finish and .s6-svscan/crash to webservices
  SCHEDULED: <2020-03-23 Mon>
#+begin_example
  root@web36 ~ # docker logs apache2-php53-hardened
  [Wed Mar 18 05:15:18.007847 2020] [mpm_prefork:notice] [pid 24] AH00163: Apache/2.4.41 (Unix) mpm-itk/2.4.7-04 PHP/5.3.29 configured -- resuming normal operations
  [Wed Mar 18 05:15:18.007892 2020] [mpm_prefork:info] [pid 24] AH00164: Server built: Aug  9 2019 13:36:47
  [Wed Mar 18 05:15:18.007905 2020] [core:notice] [pid 24] AH00094: Command line: '/nix/store/xm89nf0qg88c7l2yxxnpagl5pib8qfrc-apache-httpd-2.4.41/bin/httpd -D FOREGROUND -d /nix/store/gncm5v57wlq48v5r1h49yxxfq48wv9nq-apache2-rootfs-php53/etc/httpd'
  [Wed Mar 18 14:24:52.114603 2020] [mpm_prefork:notice] [pid 24] AH00171: Graceful restart requested, doing restart
  [Wed Mar 18 14:24:52.360462 2020] [mpm_prefork:notice] [pid 24] AH00163: Apache/2.4.41 (Unix) mpm-itk/2.4.7-04 PHP/5.3.29 configured -- resuming normal operations
  [Wed Mar 18 14:24:52.360479 2020] [mpm_prefork:info] [pid 24] AH00164: Server built: Aug  9 2019 13:36:47
  [Wed Mar 18 14:24:52.360485 2020] [core:notice] [pid 24] AH00094: Command line: '/nix/store/xm89nf0qg88c7l2yxxnpagl5pib8qfrc-apache-httpd-2.4.41/bin/httpd -D FOREGROUND -d /nix/store/gncm5v57wlq48v5r1h49yxxfq48wv9nq-apache2-rootfs-php53/etc/httpd'
  [Sun Mar 22 04:47:12.442742 2020] [reqtimeout:info] [pid 32692] [client 127.0.0.1:57438] AH01382: Request header read timeout
  s6-svscan: warning: unable to exec finish script .s6-svscan/finish: Permission denied
  s6-svscan: warning: executing into .s6-svscan/crash
  s6-svscan: fatal: unable to exec .s6-svscan/crash: No such file or directory
#+end_example
* TODO fileserver test.nix [[https://www.youtube.com/results?search_query=rsocket][rsocket - YouTube]]
  SCHEDULED: <2020-03-30 Mon>
* TODO Подключение кабеля IPMI на серверах https://cerberus.intr/index.php/profiles/ticket/AQ-84438-978/conversation/read_all
  SCHEDULED: <2020-03-29 Sun>
   - [[/home/oleg/src/nixpkgs-firefox-esr-52/pkgs/applications/networking/browsers/firefox/packages.nix][firefox]]
   - [[/home/oleg/src/nixpkgs-firefox-esr-52/pkgs/development/compilers/adoptopenjdk-icedtea-web/default.nix][icedtea]]
   - [[/home/oleg/src/nixpkgs-firefox-esr-52/jdk.nix][jdk]]
* TODO [[https://cerberus.intr/index.php/profiles/ticket/SN-11785-238/comment/7124095][Запрос из панели AC_131779 (Тема запроса: Баг в SSL-сертификате от Let's Encrypt.)]]
* TODO [[https://cerberus.intr/index.php/profiles/ticket/SV-49154-232/comment/7124536][Появились аккаунты у которых не восстановились файлы после включения (оплаты)]]
#+BEGIN_SRC markdown
  Есть юзер AC_217132, который второй раз не успел оплатить до того как аккаунт выключится.  После оплаты, аккаунт включается, заявок на восстановление баз данных нет.

  Смотрю свой аккаунт AC_208112, после включения нет тоже нет заявок. В дополнение нет заявки на создание базы данных.

  https://hms.majordomo.ru/databases
  ```
  30.03.2020 11:34:29
  Создание пользователя баз данных

  30.03.2020 11:34:34
  Создание базы данных
  ```

  robo3t
  ```
  db.getCollection('accountHistory').find({$and: [{"message": /Поступила заявка на создание базы данных/},{"personalAccountId":"208112"}]})
  ```
  https://imgur.com/PSjhAuw.png

  В контейнерах hms2_personmgr не вижу заявок и trace'ов.
#+END_SRC
* TODO Олег Пыхалов (pyhalov) opened !2 *Jenkinsfile: Add HOSTNAME parameter.* in office / ssl-certificates
  SCHEDULED: <2020-04-05 Sun>
https://gitlab.intr/office/ssl-certificates/-/merge_requests/2
16:36
Оно работает, но т.к. пароль добавлен через credentials'ы jenkins'а, то при удалении хомяка работать перестанет :b
16:37
А примеров с curl'ом я не вижу для генерации именно строки секрета, короче на потом.
16:37
Ну, мержить сейчас можно, не ломает ничего.
16:38
И еще надо будет job'ы удалять сразу, чтобы не палить серты :b

* TODO Add note about NIX CHANNEL
  SCHEDULED: <2020-03-31 Tue>

* TODO when jenkins deploy to swarm and commit has't changed will be the unstash error
  SCHEDULED: <2020-04-26 Sun>
Олег Пыхалов (pyhalov at majordomo.ru)￼  14:38
Это ок? Не может stash. https://jenkins.intr/job/monitoring/job/kapacitor/job/master/2/console
￼
14:39
если коммит не изменился, там всегда фейл

* TODO Gluster offline bricks found on dh2-mr
  SCHEDULED: <2020-05-18 Mon>
На dh2-mr нет бриков текущего гластера, но есть брики нового
(тестового). В общем конкретно на dh2-mr не обращать внимания до тех
пор, пока не сообщим о вводе нового гластера.

* TODO Add Bash script for git clone
  SCHEDULED: <2020-04-05 Sun>
: (f() { xterm -e "set -ex; cd $HOME/archive/src; git clone $1"; }; f "https://github.com/domtronn/all-the-icons.el")

* TODO Rename buildwebservice
  SCHEDULED: <2020-04-05 Sun>
#+BEGIN_SRC emacs-lisp
  (mapcar (lambda (file)
            (find-file file))
          '("/home/oleg/majordomo/apps/bitrix-start/Jenkinsfile"
            "/home/oleg/majordomo/webservices/apache2-perl518/Jenkinsfile"
            "/home/oleg/majordomo/webservices/apache2-php44/Jenkinsfile"
            "/home/oleg/majordomo/webservices/apache2-php52/Jenkinsfile"
            "/home/oleg/majordomo/webservices/apache2-php53/Jenkinsfile"
            "/home/oleg/majordomo/webservices/apache2-php54/Jenkinsfile"
            "/home/oleg/majordomo/webservices/apache2-php55/Jenkinsfile"
            "/home/oleg/majordomo/webservices/apache2-php56/Jenkinsfile"
            "/home/oleg/majordomo/webservices/apache2-php70/Jenkinsfile"
            "/home/oleg/majordomo/webservices/apache2-php71/Jenkinsfile"
            "/home/oleg/majordomo/webservices/apache2-php72/Jenkinsfile"
            "/home/oleg/majordomo/webservices/apache2-php73/Jenkinsfile"
            "/home/oleg/majordomo/webservices/apache2-php73-personal/Jenkinsfile"
            "/home/oleg/majordomo/webservices/apache2-php74/Jenkinsfile"
            "/home/oleg/majordomo/webservices/cron/Jenkinsfile"
            "/home/oleg/majordomo/webservices/ftpserver/Jenkinsfile"
            "/home/oleg/majordomo/webservices/http-fileserver/Jenkinsfile"
            "/home/oleg/majordomo/webservices/nginx/Jenkinsfile"
            "/home/oleg/majordomo/webservices/nginx-php73-private/Jenkinsfile"
            "/home/oleg/majordomo/webservices/nodejs1213/Jenkinsfile"
            "/home/oleg/majordomo/webservices/php4/Jenkinsfile"
            "/home/oleg/majordomo/webservices/php52/Jenkinsfile"
            "/home/oleg/majordomo/webservices/postfix/Jenkinsfile"
            "/home/oleg/majordomo/webservices/ssh-guest-room/Jenkinsfile"
            "/home/oleg/majordomo/webservices/ssh-sup-room/Jenkinsfile"
            "/home/oleg/majordomo/webservices/uwsgi-python37/Jenkinsfile"
            "/home/oleg/majordomo/webservices/webftp-new/Jenkinsfile"))
#+END_SRC

* TODO jenkins disable host verification ("Host Key Verification Strategy")
  SCHEDULED: <2020-04-07 Tue>

* TODO postfix staff
  SCHEDULED: <2020-04-08 Wed>
#+begin_example
  Apr  7 17:18:19 smtp-staff postfix/smtpd[1467]: 59B7131405B4: client=dh2-mr.intr[172.16.103.156]
  Apr  7 17:18:19 smtp-staff postfix/cleanup[1470]: 59B7131405B4: message-id=<cbb33f72f0b719bbbd1ffef794ff8984@mail-manager.intr>
  Apr  7 17:18:19 smtp-staff opendkim[9834]: 59B7131405B4: DKIM-Signature field added (s=dkim, d=majordomo.ru)
  Apr  7 17:18:19 smtp-staff postfix/smtpd[9269]: connect from dh1-mr.intr[172.16.103.155]
  Apr  7 17:18:19 smtp-staff postfix/smtpd[9269]: 6141A31405E0: client=dh1-mr.intr[172.16.103.155]
  Apr  7 17:18:19 smtp-staff postfix/cleanup[9272]: 6141A31405E0: message-id=<aabef4654036414e257549a0a18f91ee@mail-manager.intr>
  Apr  7 17:18:19 smtp-staff opendkim[9834]: 6141A31405E0: DKIM-Signature field added (s=dkim, d=majordomo.ru)
  Apr  7 17:18:19 smtp-staff postfix/qmgr[2976]: 59B7131405B4: from=<noreply@majordomo.ru>, size=15097, nrcpt=2 (queue active)
  Apr  7 17:18:19 smtp-staff postfix/smtpd[1467]: disconnect from dh2-mr.intr[172.16.103.156] ehlo=1 mail=1 rcpt=2 data=1 quit=1 commands=6
  Apr  7 17:18:19 smtp-staff postfix/qmgr[2976]: 6141A31405E0: from=<noreply@majordomo.ru>, size=13367, nrcpt=2 (queue active)
  Apr  7 17:18:19 smtp-staff postfix/smtpd[9269]: disconnect from dh1-mr.intr[172.16.103.155] ehlo=1 mail=1 rcpt=2 data=1 quit=1 commands=6
  Apr  7 17:18:19 smtp-staff postfix-mailout/smtp[448]: 226823160AB1: to=<alumos@mail.ru>, relay=mxs.mail.ru[94.100.180.31]:25, delay=0.62, delays=0.11/0/0.05/0.45, dsn=2.0.0, status=sent (250 OK id=1jLp3T-0008U1-BR)
  Apr  7 17:18:19 smtp-staff postfix-mailout/qmgr[5781]: 226823160AB1: removed
  Apr  7 17:18:19 smtp-staff postfix/smtp[9265]: 6141A31405E0: to=<turm@turm2rm.ru>, relay=mmxs.majordomo.ru[78.108.80.147]:25, delay=0.41, delays=0.09/0.02/0.07/0.22, dsn=2.0.0, status=sent (250 OK id=1jLp3T-0000w6-Iq)
  Apr  7 17:18:19 smtp-staff postfix/smtp[1471]: 6141A31405E0: to=<turm@mail.ru>, relay=mxs.mail.ru[94.100.180.31]:25, delay=0.59, delays=0.09/0.02/0.11/0.37, dsn=2.0.0, status=sent (250 OK id=1jLp3T-000AKw-Kx)
  Apr  7 17:18:19 smtp-staff postfix/smtp[9266]: 59B7131405B4: to=<12volt.kr@mail.ru>, relay=mxs.mail.ru[94.100.180.31]:25, delay=0.62, delays=0.11/0.03/0.11/0.38, dsn=2.0.0, status=sent (250 OK id=1jLp3T-0006I1-M0)
  Apr  7 17:18:19 smtp-staff postfix/smtp[9266]: 59B7131405B4: to=<art6.krasnodar@mail.ru>, relay=mxs.mail.ru[94.100.180.31]:25, delay=0.62, delays=0.11/0.03/0.11/0.38, dsn=2.0.0, status=sent (250 OK id=1jLp3T-0006I1-M0)
  Apr  7 17:18:19 smtp-staff postfix/qmgr[2976]: 6141A31405E0: removed
  Apr  7 17:18:20 smtp-staff postfix/qmgr[2976]: 59B7131405B4: removed
#+end_example

* TODO Moodle
  SCHEDULED: <2020-04-13 Mon>
Коля насчет Moodle что-то написал?
Юзер спрашивает доколе
https://cerberus.intr/index.php/profiles/ticket/JN-93547-362/message/14746990
Так выяснили же что либо 7.3, либо отключение опкэша
```Резвов Александр И можешь подробности по сегфолту написать
12:21
Кондрашкин Николай Одна из ситуаций когда происходит сегфолт - этап проверки конфигурации сервера при установке последней версии Moodle.
Пример стрейса: /home/u220037/yvloar.aq/strace.log на web26
12:22
Еще была жалоба на 502 от чувака с WP после того как он криво ссылки с http на https заменил и появились ссылки начинающиеся с httpss://, но как ее воспроизвести клиент не сообщил.
12:25
Резвов Александр А ссылки нет?
12:25
Кондрашкин Николай На что?
12:25
Резвов Александр На жалобу
12:28
Кондрашкин Николай https://cerberus.intr/index.php/profiles/ticket/LS-83644-341/conversation
12:29
Я его переключил на 7.3 но Дима все равно сказал сносить испорченную базу.
12:30
Резвов Александр Ладно, с мудлом будет проще воспроизвести
12:31
Кондрашкин Николай Вот http://moodle.majordomo-test.tk/admin/index.php
12:36
Резвов Александр А если выключить opcache, то работает
14:12
Кондрашкин Николай А как полностью выключить opcache?
14:12
Резвов Александр php_flag opcache.enable off```
opcache не надо раде одной cms вырубать
Так никто не предлагает его вырубать глобально
free and open-source learning management system 
Moodle is used for blended learning, distance education, flipped classroom and other e-learning projects in schools, universities, workplaces and other sectors

его реально вообще использовать на виртуальном хостиге не в курсе?
Реально
прекрасно встает на 37 вебе
урок можно провести?
:D
я просто думаю, может инсталятор запилить
Там несколько иная система (у меня в универе такая)
Он будет работать только на 37
пока да

* TODO https://jenkins.intr/job/ci/job/bfg/job/master/16/console
  SCHEDULED: <2020-04-16 Thu>
  https://jenkins.intr/job/webservices/job/nixoverlay/job/master/46/console

* TODO https://code.getnoc.com/noc/noc
  SCHEDULED: <2020-04-19 Sun>
  or use [[/home/oleg/src/work/graphviz/]]

* TODO https://gitlab.intr/_ci/maintenance-github/-/blob/master/projects.tf#L14
  SCHEDULED: <2020-04-17 Fri>
rename resource

* TODO billing2
  SCHEDULED: <2020-04-20 Mon>

изначально меня интересовало как определить какой способ установки делает perl скрипт
16:06 ты говоришь если arhive.intr не доступен одна фигня, если доступен другая
16:06 как определить какая фигня для конкретной vm12345 была выбрана
16:07 вот я и хочу исключить arhive.intr чтобы не было этого выбора


16:07
или сделать его fallback

16:08
my $checkimage = $vds->checkimage;
16:08
if ( $checkimage eq 0 ) {
                                       $vds->getimage ;
                                       $vds->do_vol_from_image ;
                               }
16:09
sub checkimage {
       my $self = shift ;
       system(sprintf("rsync --list-only rsync://archive.intr/images/jenkins-production/%s-%s.qcow2",  $self->{var}->{disk}->{template} , $self->{var}->{caps}->{disk}));
       if ( $? >>8 == 0 ) {
               print "Is available \n" ;
               return 0 ;
       }
       else {
               return 1 ;
       }
}
16:12
если будет локально, то рсинк на какой нить ls заменить и все

* TODO move to script
  SCHEDULED: <2020-04-19 Sun>
: (set -ex; for remote in origin majordomo upstream; do git push $remote; done)

* TODO Delete nixpkgs badge in https://github.com/mjuh projects
  SCHEDULED: <2020-04-30 Thu>

* TODO Jenkins job Chef Workstation fix knife
https://jenkins.intr/job/ci/job/chef-workstation/job/master/5/console

* TODO Stumpwm setenv
  SCHEDULED: <2020-04-26 Sun>
: (sb-posix:setenv "GTK_THEME" "Adwaita:dark" 1)

* TODO bizmail
  SCHEDULED: <2020-04-28 Tue>
#+begin_example
  2020-04-27 14:45:55.432 ERROR [bizmail,bf74e9dc7e82dbb7,76dad2f56fa34660,false] 1 --- [nio-8098-exec-7] r.m.h.bizmail.service.BizMailApiServi
  ce  : [addDomain] HttpClientErrorException getStatusCode(): 403 getResponseBodyAsString: {"message":"Ð¾Ð¿ Ð·Ð°Ð¿ÐµÐµÐ½"}
  2020-04-27 14:45:55.435 ERROR [bizmail,bf74e9dc7e82dbb7,76dad2f56fa34660,false] 1 --- [nio-8098-exec-7] o.s.c.s.i.web.ExceptionLoggingFilter 
      : Uncaught exception thrown

  org.springframework.web.util.NestedServletException: Request processing failed; nested exception is org.springframework.web.client.HttpClient
  ErrorException: 403 Forbidden
          at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:982) ~[spring-webmvc-5.0.9.RELEASE.jar!/:5.0
  .9.RELEASE]
          at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:877) ~[spring-webmvc-5.0.9.RELEASE.jar!/:5.0.9.RELEA
  SE]
          at javax.servlet.http.HttpServlet.service(HttpServlet.java:661) ~[tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:851) ~[spring-webmvc-5.0.9.RELEASE.jar!/:5.0.9.RELE
  ASE]
          at javax.servlet.http.HttpServlet.service(HttpServlet.java:742) ~[tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231) [tomcat-embed-core-8.5.34.jar!/:
  8.5.34]
          at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52) ~[tomcat-embed-websocket-8.5.34.jar!/:8.5.34]
          at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) [tomcat-embed-core-8.5.34.jar!/:
  8.5.34]
          at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.springframework.boot.actuate.web.trace.servlet.HttpTraceFilter.doFilterInternal(HttpTraceFilter.java:90) ~[spring-boot-actuato
  r-2.0.5.RELEASE.jar!/:2.0.5.RELEASE]
          at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) [spring-web-5.0.9.RELEASE.jar!/:5.0.9.
  RELEASE]
          at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) [tomcat-embed-core-8.5.34.jar!/:
  8.5.34]
          at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:320) ~[spring-security-web-5.0
  .8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:127) ~[spring-se
  curity-web-5.0.8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:91) ~[spring-s
  ecurity-web-5.0.8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.0
  .8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:119) ~[spring-security
  -web-5.0.8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.0
  .8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:137) ~[spring-security-web-
  5.0.8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.0
  .8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:111) ~[s
  pring-security-web-5.0.8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.0
  .8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilt
  er.java:170) ~[spring-security-web-5.0.8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.0
  .8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63) ~[spring-security-
  web-5.0.8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.0
  .8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.oauth2.provider.authentication.OAuth2AuthenticationProcessingFilter.doFilter(OAuth2AuthenticationProc
  essingFilter.java:176) ~[spring-security-oauth2-2.2.1.RELEASE.jar!/:na]
          at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.0
  .8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:116) ~[spring-security-web-5.0.8.RE
  LEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.0
  .8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:66) ~[spring-security-web-5.0.
  8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) [spring-web-5.0.9.RELEASE.jar!/:5.0.9.
  RELEASE]
          at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.0
  .8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:105) ~[sp
  ring-security-web-5.0.8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.0
  .8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegratio
  nFilter.java:56) ~[spring-security-web-5.0.8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) [spring-web-5.0.9.RELEASE.jar!/:5.0.9.
  RELEASE]
          at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.0
  .8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:215) ~[spring-security-web-5.0.8.RELEASE.
  jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:178) ~[spring-security-web-5.0.8.RELEASE.jar!/:5.
  0.8.RELEASE]
          at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:357) ~[spring-web-5.0.9.RELEASE.jar
  !/:5.0.9.RELEASE]
          at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:270) ~[spring-web-5.0.9.RELEASE.jar!/:5.0
  .9.RELEASE]
          at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) [tomcat-embed-core-8.5.34.jar!/:
  8.5.34]
          at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.springframework.web.filter.HttpPutFormContentFilter.doFilterInternal(HttpPutFormContentFilter.java:109) ~[spring-web-5.0.9.REL
  EASE.jar!/:5.0.9.RELEASE]
          at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) [spring-web-5.0.9.RELEASE.jar!/:5.0.9.
  RELEASE]
          at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) [tomcat-embed-core-8.5.34.jar!/:
  8.5.34]
          at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:93) ~[spring-web-5.0.9.RELEASE.
  jar!/:5.0.9.RELEASE]
          at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) [spring-web-5.0.9.RELEASE.jar!/:5.0.9.
  RELEASE]
          at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) [tomcat-embed-core-8.5.34.jar!/:
  8.5.34]
          at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.springframework.cloud.sleuth.instrument.web.ExceptionLoggingFilter.doFilter(ExceptionLoggingFilter.java:48) ~[spring-cloud-sle
  uth-core-2.0.1.RELEASE.jar!/:2.0.1.RELEASE]
          at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) [tomcat-embed-core-8.5.34.jar!/:
  8.5.34]
          at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at brave.servlet.TracingFilter.doFilter(TracingFilter.java:86) [brave-instrumentation-servlet-5.1.4.jar!/:na]
          at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) [tomcat-embed-core-8.5.34.jar!/:
  8.5.34]
          at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.filterAndRecordMetrics(WebMvcMetricsFilter.java:155) [spr
  ing-boot-actuator-2.0.5.RELEASE.jar!/:2.0.5.RELEASE]
          at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.filterAndRecordMetrics(WebMvcMetricsFilter.java:123) [spr
  ing-boot-actuator-2.0.5.RELEASE.jar!/:2.0.5.RELEASE]
          at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:108) [spring-bo
  ot-actuator-2.0.5.RELEASE.jar!/:2.0.5.RELEASE]
          at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) [spring-web-5.0.9.RELEASE.jar!/:5.0.9.
  RELEASE]
          at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) [tomcat-embed-core-8.5.34.jar!/:
  8.5.34]
          at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:200) [spring-web-5.0.9.RELEAS
  E.jar!/:5.0.9.RELEASE]
          at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) [spring-web-5.0.9.RELEASE.jar!/:5.0.9.
  RELEASE]
          at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) [tomcat-embed-core-8.5.34.jar!/:
  8.5.34]
          at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:198) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:493) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:140) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:81) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:800) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:806) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1498) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [na:1.8.0_242]
          at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [na:1.8.0_242]
          at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at java.lang.Thread.run(Thread.java:748) [na:1.8.0_242]
  Caused by: org.springframework.web.client.HttpClientErrorException: 403 Forbidden
          at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:94) ~[spring-web-5.0.9.REL
  EASE.jar!/:5.0.9.RELEASE]
          at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:79) ~[spring-web-5.0.9.REL
  EASE.jar!/:5.0.9.RELEASE]
          at org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63) ~[spring-web-5.0.9.RELEASE.jar!/:5.0
  .9.RELEASE]
          at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:730) ~[spring-web-5.0.9.RELEASE.jar!/:5.0.9.RELEASE]
          at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:688) ~[spring-web-5.0.9.RELEASE.jar!/:5.0.9.RELEASE]
          at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:644) ~[spring-web-5.0.9.RELEASE.jar!/:5.0.9.RELEASE]
          at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:564) ~[spring-web-5.0.9.RELEASE.jar!/:5.0.9.RELEASE]
          at ru.majordomo.hms.bizmail.service.BizMailApiService.addDomain(BizMailApiService.java:402) ~[classes!/:na]
          at ru.majordomo.hms.bizmail.manager.impl.DomainManagerImpl.addToBizMail(DomainManagerImpl.java:189) ~[classes!/:na]
          at ru.majordomo.hms.bizmail.manager.impl.DomainManagerImpl$$FastClassBySpringCGLIB$$f769313.invoke(<generated>) ~[classes!/:na]
          at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204) ~[spring-core-5.0.9.RELEASE.jar!/:5.0.9.RELEASE]
          at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:746) ~[spring-aop-5.0.9.R
  ELEASE.jar!/:5.0.9.RELEASE]
          at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.0.9.RELEA
  SE.jar!/:5.0.9.RELEASE]
          at org.springframework.retry.annotation.AnnotationAwareRetryOperationsInterceptor.invoke(AnnotationAwareRetryOperationsInterceptor.ja
  va:155) ~[spring-retry-1.2.1.RELEASE.jar!/:na]
          at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:185) ~[spring-aop-5.0.9.RELEA
  SE.jar!/:5.0.9.RELEASE]
          at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:688) ~[spring-aop-5.0.9.REL
  EASE.jar!/:5.0.9.RELEASE]
          at ru.majordomo.hms.bizmail.manager.impl.DomainManagerImpl$$EnhancerBySpringCGLIB$$beeb111e.addToBizMail(<generated>) ~[classes!/:na]
          at ru.majordomo.hms.bizmail.controller.DomainRestController.add(DomainRestController.java:53) ~[classes!/:na]
          at ru.majordomo.hms.bizmail.controller.DomainRestController$$FastClassBySpringCGLIB$$54b52e6f.invoke(<generated>) ~[classes!/:na]
          at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204) ~[spring-core-5.0.9.RELEASE.jar!/:5.0.9.RELEASE]
          at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:746) ~[spring-aop-5.0.9.R
  ELEASE.jar!/:5.0.9.RELEASE]
          at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.0.9.RELEA
  SE.jar!/:5.0.9.RELEASE]
          at org.springframework.security.access.intercept.aopalliance.MethodSecurityInterceptor.invoke(MethodSecurityInterceptor.java:69) ~[sp
  ring-security-core-5.0.8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:185) ~[spring-aop-5.0.9.RELEA
  SE.jar!/:5.0.9.RELEASE]
          at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:688) ~[spring-aop-5.0.9.REL
  EASE.jar!/:5.0.9.RELEASE]
          at ru.majordomo.hms.bizmail.controller.DomainRestController$$EnhancerBySpringCGLIB$$6d38af60.add(<generated>) ~[classes!/:na]
          at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_242]
          at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_242]
          at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_242]
          at java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_242]
          at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:209) ~[spring-web-5.0.9.RELEASE
  .jar!/:5.0.9.RELEASE]
          at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:136) ~[spring-web-5.0.9
  .RELEASE.jar!/:5.0.9.RELEASE]
          at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.
  java:102) ~[spring-webmvc-5.0.9.RELEASE.jar!/:5.0.9.RELEASE]
          at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapte
  r.java:891) ~[spring-webmvc-5.0.9.RELEASE.jar!/:5.0.9.RELEASE]
          at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.jav
  a:797) ~[spring-webmvc-5.0.9.RELEASE.jar!/:5.0.9.RELEASE]
          at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webm
  vc-5.0.9.RELEASE.jar!/:5.0.9.RELEASE]
          at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:991) ~[spring-webmvc-5.0.9.RELEASE.jar!/:5.0.9
  .RELEASE]
          at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:925) ~[spring-webmvc-5.0.9.RELEASE.jar!/:5.0.9.
  RELEASE]
          at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:974) ~[spring-webmvc-5.0.9.RELEASE.jar!/:5.0
  .9.RELEASE]
          ... 85 common frames omitted

  2020-04-27 14:45:55.436 ERROR [bizmail,,,] 1 --- [nio-8098-exec-7] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [
  dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is org.springframework.web.client.Htt
  pClientErrorException: 403 Forbidden] with root cause

  org.springframework.web.client.HttpClientErrorException: 403 Forbidden
          at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:94) ~[spring-web-5.0.9.REL
  EASE.jar!/:5.0.9.RELEASE]
          at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:79) ~[spring-web-5.0.9.REL
  EASE.jar!/:5.0.9.RELEASE]
          at org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63) ~[spring-web-5.0.9.RELEASE.jar!/:5.0
  .9.RELEASE]
          at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:730) ~[spring-web-5.0.9.RELEASE.jar!/:5.0.9.RELEASE]
          at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:688) ~[spring-web-5.0.9.RELEASE.jar!/:5.0.9.RELEASE]
          at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:644) ~[spring-web-5.0.9.RELEASE.jar!/:5.0.9.RELEASE]
          at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:564) ~[spring-web-5.0.9.RELEASE.jar!/:5.0.9.RELEASE]
          at ru.majordomo.hms.bizmail.service.BizMailApiService.addDomain(BizMailApiService.java:402) ~[classes!/:na]
          at ru.majordomo.hms.bizmail.manager.impl.DomainManagerImpl.addToBizMail(DomainManagerImpl.java:189) ~[classes!/:na]
          at ru.majordomo.hms.bizmail.manager.impl.DomainManagerImpl$$FastClassBySpringCGLIB$$f769313.invoke(<generated>) ~[classes!/:na]
          at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204) ~[spring-core-5.0.9.RELEASE.jar!/:5.0.9.RELEASE]
          at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:746) ~[spring-aop-5.0.9.R
  ELEASE.jar!/:5.0.9.RELEASE]
          at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.0.9.RELEA
  SE.jar!/:5.0.9.RELEASE]
          at org.springframework.retry.annotation.AnnotationAwareRetryOperationsInterceptor.invoke(AnnotationAwareRetryOperationsInterceptor.ja
  va:155) ~[spring-retry-1.2.1.RELEASE.jar!/:na]
          at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:185) ~[spring-aop-5.0.9.RELEA
  SE.jar!/:5.0.9.RELEASE]
          at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:688) ~[spring-aop-5.0.9.REL
  EASE.jar!/:5.0.9.RELEASE]
          at ru.majordomo.hms.bizmail.manager.impl.DomainManagerImpl$$EnhancerBySpringCGLIB$$beeb111e.addToBizMail(<generated>) ~[classes!/:na]
          at ru.majordomo.hms.bizmail.controller.DomainRestController.add(DomainRestController.java:53) ~[classes!/:na]
          at ru.majordomo.hms.bizmail.controller.DomainRestController$$FastClassBySpringCGLIB$$54b52e6f.invoke(<generated>) ~[classes!/:na]
          at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204) ~[spring-core-5.0.9.RELEASE.jar!/:5.0.9.RELEASE]
          at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:746) ~[spring-aop-5.0.9.R
  ELEASE.jar!/:5.0.9.RELEASE]
          at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.0.9.RELEA
  SE.jar!/:5.0.9.RELEASE]
          at org.springframework.security.access.intercept.aopalliance.MethodSecurityInterceptor.invoke(MethodSecurityInterceptor.java:69) ~[sp
  ring-security-core-5.0.8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:185) ~[spring-aop-5.0.9.RELEA
  SE.jar!/:5.0.9.RELEASE]
          at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:688) ~[spring-aop-5.0.9.REL
  EASE.jar!/:5.0.9.RELEASE]
          at ru.majordomo.hms.bizmail.controller.DomainRestController$$EnhancerBySpringCGLIB$$6d38af60.add(<generated>) ~[classes!/:na]
          at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_242]
          at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_242]
          at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_242]
          at java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_242]
          at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:209) ~[spring-web-5.0.9.RELEASE
  .jar!/:5.0.9.RELEASE]
          at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:136) ~[spring-web-5.0.9
  .RELEASE.jar!/:5.0.9.RELEASE]
          at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.
  java:102) ~[spring-webmvc-5.0.9.RELEASE.jar!/:5.0.9.RELEASE]
          at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapte
  r.java:891) ~[spring-webmvc-5.0.9.RELEASE.jar!/:5.0.9.RELEASE]
          at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.jav
  a:797) ~[spring-webmvc-5.0.9.RELEASE.jar!/:5.0.9.RELEASE]
          at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webm
  vc-5.0.9.RELEASE.jar!/:5.0.9.RELEASE]
          at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:991) ~[spring-webmvc-5.0.9.RELEASE.jar!/:5.0.9
  .RELEASE]
          at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:925) ~[spring-webmvc-5.0.9.RELEASE.jar!/:5.0.9.
  RELEASE]
          at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:974) ~[spring-webmvc-5.0.9.RELEASE.jar!/:5.0
  .9.RELEASE]
          at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:877) ~[spring-webmvc-5.0.9.RELEASE.jar!/:5.0.9.RELEA
  SE]
          at javax.servlet.http.HttpServlet.service(HttpServlet.java:661) ~[tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:851) ~[spring-webmvc-5.0.9.RELEASE.jar!/:5.0.9.RELE
  ASE]
          at javax.servlet.http.HttpServlet.service(HttpServlet.java:742) ~[tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231) ~[tomcat-embed-core-8.5.34.jar!/
  :8.5.34]
          at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52) ~[tomcat-embed-websocket-8.5.34.jar!/:8.5.34]
          at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-8.5.34.jar!/
  :8.5.34]
          at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.springframework.boot.actuate.web.trace.servlet.HttpTraceFilter.doFilterInternal(HttpTraceFilter.java:90) ~[spring-boot-actuato
  r-2.0.5.RELEASE.jar!/:2.0.5.RELEASE]
          at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-5.0.9.RELEASE.jar!/:5.0.9
  .RELEASE]
          at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-8.5.34.jar!/
  :8.5.34]
          at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:320) ~[spring-security-web-5.0
  .8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:127) ~[spring-se
  curity-web-5.0.8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:91) ~[spring-s
  ecurity-web-5.0.8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.0
  .8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:119) ~[spring-security
  -web-5.0.8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.0
  .8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:137) ~[spring-security-web-
  5.0.8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.0
  .8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:111) ~[s
  pring-security-web-5.0.8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.0
  .8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilt
  er.java:170) ~[spring-security-web-5.0.8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.0
  .8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63) ~[spring-security-
  web-5.0.8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.0
  .8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.oauth2.provider.authentication.OAuth2AuthenticationProcessingFilter.doFilter(OAuth2AuthenticationProc
  essingFilter.java:176) ~[spring-security-oauth2-2.2.1.RELEASE.jar!/:na]
          at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.0
  .8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:116) ~[spring-security-web-5.0.8.RE
  LEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.0
  .8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:66) ~[spring-security-web-5.0.
  8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-5.0.9.RELEASE.jar!/:5.0.9
  .RELEASE]
          at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.0
  .8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:105) ~[sp
  ring-security-web-5.0.8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.0
  .8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegratio
  nFilter.java:56) ~[spring-security-web-5.0.8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-5.0.9.RELEASE.jar!/:5.0.9
  .RELEASE]
          at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) ~[spring-security-web-5.0
  .8.RELEASE.jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:215) ~[spring-security-web-5.0.8.RELEASE.
  jar!/:5.0.8.RELEASE]
          at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:178) ~[spring-security-web-5.0.8.RELEASE.jar!/:5.
  0.8.RELEASE]
          at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:357) ~[spring-web-5.0.9.RELEASE.jar
  !/:5.0.9.RELEASE]
          at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:270) ~[spring-web-5.0.9.RELEASE.jar!/:5.0
  .9.RELEASE]
          at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-8.5.34.jar!/
  :8.5.34]
          at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.springframework.web.filter.HttpPutFormContentFilter.doFilterInternal(HttpPutFormContentFilter.java:109) ~[spring-web-5.0.9.REL
  EASE.jar!/:5.0.9.RELEASE]
          at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-5.0.9.RELEASE.jar!/:5.0.9
  .RELEASE]
          at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-8.5.34.jar!/
  :8.5.34]
          at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:93) ~[spring-web-5.0.9.RELEASE.
  jar!/:5.0.9.RELEASE]
          at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-5.0.9.RELEASE.jar!/:5.0.9
  .RELEASE]
          at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-8.5.34.jar!/
  :8.5.34]
          at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.springframework.cloud.sleuth.instrument.web.ExceptionLoggingFilter.doFilter(ExceptionLoggingFilter.java:48) ~[spring-cloud-sle
  uth-core-2.0.1.RELEASE.jar!/:2.0.1.RELEASE]
          at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-8.5.34.jar!/
  :8.5.34]
          at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at brave.servlet.TracingFilter.doFilter(TracingFilter.java:86) ~[brave-instrumentation-servlet-5.1.4.jar!/:na]
          at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-8.5.34.jar!/
  :8.5.34]
          at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.filterAndRecordMetrics(WebMvcMetricsFilter.java:155) ~[sp
  ring-boot-actuator-2.0.5.RELEASE.jar!/:2.0.5.RELEASE]
          at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.filterAndRecordMetrics(WebMvcMetricsFilter.java:123) ~[sp
  ring-boot-actuator-2.0.5.RELEASE.jar!/:2.0.5.RELEASE]
          at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:108) ~[spring-b
  oot-actuator-2.0.5.RELEASE.jar!/:2.0.5.RELEASE]
          at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-5.0.9.RELEASE.jar!/:5.0.9
  .RELEASE]
          at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-8.5.34.jar!/
  :8.5.34]
          at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:200) ~[spring-web-5.0.9.RELEA
  SE.jar!/:5.0.9.RELEASE]
          at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-5.0.9.RELEASE.jar!/:5.0.9
  .RELEASE]
          at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-8.5.34.jar!/
  :8.5.34]
          at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:198) ~[tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:493) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:140) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:81) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:800) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:806) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1498) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [na:1.8.0_242]
          at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [na:1.8.0_242]
          at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-8.5.34.jar!/:8.5.34]
          at java.lang.Thread.run(Thread.java:748) [na:1.8.0_242]
#+end_example

[15:32] <rezvov:rezvov> Видео 10/10
[15:32] <pyhalov:natsu> удобнее чем писать :b
[15:35] <rezvov:rezvov> Не помню чтобы почта от мыла ломалась по другой причине. Мне кажется стоит добавить проверку на аккаунт к которому подключают и как-то обрабатывать эту ситуацию

* TODO Add to Redmine task to allow shared hosting users select only NGINX without proxy
  SCHEDULED: <2020-04-30 Thu>

* TODO Delete NGINX config
  SCHEDULED: <2020-05-01 Fri>
  [[/ssh:web28.intr|sudo:root@web28.intr:/etc/nginx/sites-available/598c3a79bfae8f41261b26b1.conf]]
  [[https://cerberus.intr/index.php/profiles/ticket/FS-75156-842/message/14885050]]

* TODO [[#YW-56173-324][У перенесенных аккаунтов HMS меняется владелец логов - Cerberus Helpdesk :: Majordomo.ru mail]]
  SCHEDULED: <2020-04-30 Thu>
[[file:~/majordomo/hms/taskexecutor/src/python/taskexecutor/resprocessor.py::os.makedirs(os.path.join(self.resource.homeDir,%20"logs"),%20mode=0o755,%20exist_ok=True)]]
[[file:~/majordomo/hms/taskexecutor/src/python/taskexecutor/sysservice.py::os.chown(home_dir,%20uid,%20uid)]]

* TODO http-fileserver
  SCHEDULED: <2020-04-30 Thu>
#+begin_example
  я чистый gz не юзал
  ```gzip -c .emacs > emacs.gz
  $(nix-build '<nixpkgs>' --no-out-link -A libarchive)/bin/bsdtar -xf emacs.gz```
  `bsdtar: Error opening archive: Unrecognized archive format`
  Сложна.
  bsdtar наверное для tar
  :kekw:
  ```$(nix-build '<nixpkgs>' --no-out-link -A libarchive)/bin/bsdcat emacs.gz```
  :aw_yeah:
  ```oleg@guixsd ~$ file emacs.gz 
  emacs.gz: gzip compressed data, was ".emacs", last modified: Wed Apr 29 14:04:10 2020, from Unix, original size 7706```
  ```oleg@guixsd ~$ file --mime emacs.gz 
  emacs.gz: application/x-gzip; charset=binary```
  ```
  3 matches for "format" in buffer: unarc.lua
       48:function unarc(uid, dst_dir, arc_len, format)
       66:  if format == 'application/x-rar-compressed' then
       77:  elseif format == 'application/x-7z-compressed' then
  [edit] ```3 matches for "format" in buffer: unarc.lua
       48:function unarc(uid, dst_dir, arc_len, format)
       66:  if format == 'application/x-rar-compressed' then
       77:  elseif format == 'application/x-7z-compressed' then```
  (Old message: ```
  3 matches for "format" in buffer: unarc.lua
       48:function unarc(uid, dst_dir, arc_len, format)
       66:  if format == 'application/x-rar-compressed' then
       77:  elseif format == 'application/x-7z-compressed' then)
  ```  else
      args = {'s6-setuidgid', uid..':'..uid,
              'foreground',
              ' redirfd', ' -w', ' 2', ' '..stderr_file,
              ' bsdtar', ' -C', ' '..dst_dir, ' -xf', ' -',
              '',
              'redirfd', '-w', '1', exitcode_file, 'importas', '?', '?', 's6-echo', '${?}'}
    end```
  Эй, ну почти сделали же :b
  fallocate, воу, а я dd юзал
  ```
      static contentTypesForArchiveUpload() {
          return [
              {name: 'application/x-tar', extensions: ['.tar']},
              {name: 'application/x-compressed', extensions: ['.tar.gz', '.tgz']},
              {name: 'application/x-rar-compressed', extensions: ['.rar']},
              {name: 'application/x-zip-compressed', extensions: ['.zip']},
              {name: 'application/x-7z-compressed', extensions: ['.7z']}
          ]
      }```
  наверное не сложно пропустить
#+end_example

* TODO Clean up src and archive/src
  SCHEDULED: <2020-05-03 Sun>

- [ ] hello-terraform
- [ ] runc
- [ ] src/erza
- [ ] src/docker-tftp move to src/docker-wigust
- [ ] Move git repositories out of archive/src/tmp

* TODO Stray
  SCHEDULED: <2020-05-03 Sun>
warning: stray .go files: ./gnu/packages/ham-radio.go ./gnu/packages/sdr.go

* TODO meta slash
  SCHEDULED: <2020-05-09 Sat>
    (define-key map (kbd "M-/") 'vterm-send-meta-sl)

* TODO mode-line show zombies count
  SCHEDULED: <2020-05-09 Sat>
: ps axo pid=,stat= | awk '$2~/^Z/ { print $1 }'

* TODO vnc
  SCHEDULED: <2020-05-12 Tue>
- good 5f97103337eabadd95f913eb9300225b0c2cad2b
- Use package-version instead of %tigervnc-VARIABLES

* TODO Add projectile-known-projects to wi-project-ivy
  SCHEDULED: <2020-05-12 Tue>

* TODO Add exec -a "SERVICE_NAME-java" to HMS projects
  SCHEDULED: <2020-06-01 Mon>

* TODO StumpWM update mode-line after font change
  SCHEDULED: <2020-05-17 Sun>
#+begin_quote
[14:51] <#stumpwm:mood> Do you enable your mode line before setting the font?
[14:52] <#stumpwm:boeg> yes
[14:52] <#stumpwm:boeg> should i swithc that?
[14:52] <#stumpwm:boeg> swithc*
[14:52] <#stumpwm:boeg> switch*
[14:52] <#stumpwm:mood> Ah. Then it's created with the old font, setting the height, and won't update until the next redraw
[14:52] <#stumpwm:mood> So yes
[14:52] <#stumpwm:boeg> alright
[14:52] <#stumpwm:boeg> yes, seems to work
[14:53] <#stumpwm:mood> Perhaps we could make set-font fix that automatically
#+end_quote

* TODO jenkins -> gitlab 403
[[https://gitlab.com/gitlab-org/gitlab/-/issues/210389][#210389]]
#+begin_example
  avax.ws.rs.ClientErrorException: HTTP 403 Forbidden
         at org.jboss.resteasy.client.jaxrs.internal.ClientInvocation.handleErrorStatus(ClientInvocation.java:216)
         at org.jboss.resteasy.client.jaxrs.internal.proxy.extractors.DefaultEntityExtractorFactory$3.extractEntity(DefaultEntityExtractorFactory.java:50)
         at org.jboss.resteasy.client.jaxrs.internal.proxy.ClientInvoker.invoke(ClientInvoker.java:104)
         at org.jboss.resteasy.client.jaxrs.internal.proxy.ClientProxy.invoke(ClientProxy.java:64)
         at com.dabsquared.gitlabjenkins.gitlab.api.impl.$Proxy134.changeBuildStatus(Unknown Source)
         at com.dabsquared.gitlabjenkins.gitlab.api.impl.ResteasyGitLabClient.changeBuildStatus(ResteasyGitLabClient.java:60)
         at com.dabsquared.gitlabjenkins.gitlab.api.impl.AutodetectingGitLabClient$7.execute(AutodetectingGitLabClient.java:112)
         at com.dabsquared.gitlabjenkins.gitlab.api.impl.AutodetectingGitLabClient$7.execute(AutodetectingGitLabClient.java:109)
         at com.dabsquared.gitlabjenkins.gitlab.api.impl.AutodetectingGitLabClient$GitLabOperation.execute(AutodetectingGitLabClient.java:335)
         at com.dabsquared.gitlabjenkins.gitlab.api.impl.AutodetectingGitLabClient$GitLabOperation.access$100(AutodetectingGitLabClient.java:332)
         at com.dabsquared.gitlabjenkins.gitlab.api.impl.AutodetectingGitLabClient.execute(AutodetectingGitLabClient.java:328)
         at com.dabsquared.gitlabjenkins.gitlab.api.impl.AutodetectingGitLabClient.changeBuildStatus(AutodetectingGitLabClient.java:108)
         at com.dabsquared.gitlabjenkins.util.CommitStatusUpdater.updateCommitStatus(CommitStatusUpdater.java:85)
         at com.dabsquared.gitlabjenkins.util.CommitStatusUpdater.updateCommitStatus(CommitStatusUpdater.java:97)
         at com.dabsquared.gitlabjenkins.workflow.GitLabBuildsStep$GitLabBuildStepExecution$1.onStart(GitLabBuildsStep.java:85)
         at org.jenkinsci.plugins.workflow.cps.CpsBodyExecution.launch(CpsBodyExecution.java:135)
         at org.jenkinsci.plugins.workflow.cps.CpsBodyInvoker.launch(CpsBodyInvoker.java:187)
         at org.jenkinsci.plugins.workflow.cps.DSL$ThreadTaskImpl.lambda$invokeBodiesAndSwitchToAsyncMode$0(DSL.java:660)
         at org.jenkinsci.plugins.workflow.cps.CpsStepContext.withBodyInvokers(CpsStepContext.java:537)
         at org.jenkinsci.plugins.workflow.cps.DSL$ThreadTaskImpl.invokeBodiesAndSwitchToAsyncMode(DSL.java:650)
         at org.jenkinsci.plugins.workflow.cps.DSL$ThreadTaskImpl.eval(DSL.java:615)
         at org.jenkinsci.plugins.workflow.cps.CpsThread.runNextChunk(CpsThread.java:195)
         at org.jenkinsci.plugins.workflow.cps.CpsThreadGroup.run(CpsThreadGroup.java:405)
         at org.jenkinsci.plugins.workflow.cps.CpsThreadGroup.access$400(CpsThreadGroup.java:96)
         at org.jenkinsci.plugins.workflow.cps.CpsThreadGroup$2.call(CpsThreadGroup.java:317)
         at org.jenkinsci.plugins.workflow.cps.CpsThreadGroup$2.call(CpsThreadGroup.java:281)
         at org.jenkinsci.plugins.workflow.cps.CpsVmExecutorService$2.call(CpsVmExecutorService.java:67)
         at java.util.concurrent.FutureTask.run(FutureTask.java:266)
         at hudson.remoting.SingleLaneExecutorService$1.run(SingleLaneExecutorService.java:131)
         at jenkins.util.ContextResettingExecutorService$1.run(ContextResettingExecutorService.java:28)
         at jenkins.security.ImpersonatingExecutorService$1.run(ImpersonatingExecutorService.java:59)
         at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
         at java.util.concurrent.FutureTask.run(FutureTask.java:266)
         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
         at java.lang.Thread.run(Thread.java:748)
#+end_example

Понял почему 403 отдается на запросы с jenkins в gitlab - так происходит если включена защита у бранчи в gitlab (options -> repository) от force push'a

17:39 gitlab upstream в курсе, наверное починят
17:40 если защиту выключаешь, то все работает
17:40 (unprotect)
17:41 https://gitlab.intr/webservices/webftp-new/-/settings/repository#js-protected-branches-settings
https://github.com/jenkinsci/gitlab-plugin/issues/883
https://gitlab.com/gitlab-org/gitlab/-/issues/210389

* TODO guix deploy
  SCHEDULED: <2020-05-20 Wed>
#+BEGIN_SRC groovy

                          // Build system and manifest with current Guix
                          sh (["guix system build $WORKSPACE/dotfiles/guixsd/${hostname}.scm",
                               "guix environment --manifest=$WORKSPACE/dotfiles/manifests/${hostname}.scm -- sh -c exit"].join("; "))

#+END_SRC

* TODO Fix ci-chef-workstation jenkins job
  SCHEDULED: <2020-05-18 Mon>

* TODO TRAMP
  SCHEDULED: <2020-05-17 Sun>
  (find-file "/ssh:web33.intr|sudo:web33.intr|docker:apache2-php73-unsafe:")

* TODO YouTube
  SCHEDULED: <2020-05-17 Sun>

  - UC2eYFnH61tmytImy1mTYvhA :: Luke Smith
  - UC4RssVemaZlrfdWbp1Wx :: Стримы Тангара
  - UCVls1GmFKf6WlTraIb_IaJg :: DistroTube
  - UCK-d8Z08ElRz0zgKiAla5fg :: Tangar streams


* TODO Replace Zabbix web interface with alerta
  SCHEDULED: <2020-03-08 Sun>
* TODO Add docker alias
  SCHEDULED: <2020-03-19 Thu>
  #+BEGIN_SRC bash
    for service in $(docker service ls -q); do
      docker service inspect --format \
         '{{.Spec.Name}}: {{range .Endpoint.VirtualIPs}}{{.Addr}} {{end}}' \
         ${service}
    done
  #+END_SRC
* TODO Xorg keyboard layout
  SCHEDULED: <2020-03-18 Wed>
#+begin_example
  Section "InputClass"
    Identifier "Keyboard catchall"
    MatchIsKeyboard "on"
    Option "XkbModel" "pc104"
    Option "XkbLayout" "us,ru"
    Option "XkbOptions" "grp:menu_toggle,grp_led:scroll"
    Option "XkbVariant" ""
  EndSection
#+end_example
* TODO Parser Lebedeva /usr/lib/x86_64-linux-gnu/libmysqlclient.so.18
  SCHEDULED: <2020-01-20 Mon> DEADLINE: <2020-01-20 Mon>
* TODO MySQL upgrade
  SCHEDULED: <2020-01-31 Fri>
** mariadb docker run --restart unless-stopped
   SCHEDULED: <2020-04-13 Mon>

 2020-04-19 20:08:54 0 [ERROR] InnoDB: Downgrade after a crash is not supported. The redo log was created with MariaDB 10.4.12.
 2020-04-19 20:08:54 0 [ERROR] InnoDB: Plugin initialization aborted with error Generic error

 https://www.percona.com/blog/2013/09/11/how-to-move-the-innodb-log-sequence-number-lsn-forward/
* TODO [[https://billing2.intr/vds/queue/item/257839][Freebsd Billing2 task]]
  SCHEDULED: <2020-01-20 Mon>
* TODO [[http://redmine.intr/issues/8833][Обновление MariaDB]]
  SCHEDULED: <2020-01-31 Fri>
* TODO NGINX Unit for NodeJS hosting
  SCHEDULED: <2020-01-24 Fri>
* TODO [[/home/oleg/src/gitlab.intr/Jenkinsfile]]
  SCHEDULED: <2020-01-26 Sun>
* TODO [[https://github.com/michaudg/godaddy-ddns/blob/master/godaddy.sh]]
  SCHEDULED: <2020-01-26 Sun>
* TODO Если размер базы больше чем 1.5 ГБ, то ее размер не учитывается. Пример b213062_test
  SCHEDULED: <2020-01-31 Fri>
* TODO [[https://fosdem.org/2020/schedule/events/][FOSDEM 2020 - Events]]
  SCHEDULED: <2020-02-09 Sun>
* TODO Fix configs in [[https://gitlab.intr/utils/ipmiview][ipmiview]] (need to symlink them)
  SCHEDULED: <2020-02-25 Tue>
* TODO Nixify Bitrix
  SCHEDULED: <2020-08-31 Mon>
* TODO Nixify PXE ~/majordomo/net/pxe/
  SCHEDULED: <2020-12-13 Sun>
* TODO debian9 $osVariant   = "debian8"; /ssh:kvm15.intr|sudo:root@kvm15.intr:/usr/local/repo/lib/kvm.pm
  SCHEDULED: <2020-02-05 Wed>
* TODO [[https://github.com/NixOS/nix/issues/2208][nix-shell dependencies can be garbage collected any time now / persistent nix-shell envs ?? Issue #2208 ?? NixOS/nix]]
  SCHEDULED: <2020-03-09 Mon>
* TODO [[https://kibana.intr/goto/5b656d4c6b23e85df3a38a9aeb9744e9][logstash te userid as field]]
  SCHEDULED: <2020-03-08 Sun>
* TODO Elastic save servers .bash_history
  SCHEDULED: <2020-03-31 Tue>
* TODO Shedule cron Jenkins jobs for projects in HMS group
  SCHEDULED: <2020-03-31 Tue>
* TODO [[https://grafana.com/docs/grafana/latest/administration/image_rendering/][Image rendering | Grafana Labs]]
  SCHEDULED: <2020-03-02 Mon>
* TODO [[https://github.com/abrander/phpfpmtop][abrander/phpfpmtop: A top like interface for PHP-FPM]]
  SCHEDULED: <2020-03-08 Sun>
* TODO Install [[https://github.com/raviqqe/muffet][raviqqe/muffet: Fast website link checker in Go]]
  SCHEDULED: <2020-03-11 Wed>
* TODO split git commit to a separate stage in awesome
  SCHEDULED: <2020-03-15 Sun>
* TODO session-environment-service-type /home/oleg/src/guix-master/gnu/system/pam.scm
  SCHEDULED: <2020-03-15 Sun>
* TODO https://travis-ci.org/github/mkoppanen/imagick/jobs/527363899/config
  SCHEDULED: <2020-03-31 Tue>
* TODO Switch to python test in Majordomo nixpkgs
  SCHEDULED: <2020-09-01 Tue>
#+begin_example
      start_all()
      server.wait_for_unit("mysql");
      server.wait_for_unit("nginx");
      sleep(5);
      assert "This file is part of nginx" in succeed(
          "curl --fail --header 'example.com' 127.0.0.1/index.php"
      )
#+end_example
* TODO [[https://cerberus.intr/index.php/profiles/ticket/EZ-75759-736/conversation/read_all][Mail notification in sieve]]
  SCHEDULED: <2021-08-02 Mon>
  https://www.rfc-editor.org/rfc/rfc5436.html
* TODO Add PHP update notification [[/home/oleg/archive/src/tmp/php-versions.org][script]]
  SCHEDULED: <2020-03-23 Mon>
  #+BEGIN_SRC bash
    for version in $(curl --silent 'https://news-web.php.net/group.php?group=php.announce&format=rss' | xq --raw-output '.rss.channel.item[] | .title' | awk '/Released/ { print $2 }'); do echo curl --request POST "https://alerta.intr/api/alert" --header "Authorization: Key xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" --header "Content-type: application/json" -d "{\"resource\": \"ci\", \"event\": \"php.version.$version\", \"environment\": \"Production\", \"severity\": \"info\", \"correlate\": [], \"service\": [\"webservices\"], \"group\": null, \"value\": \"$version\", \"text\": \"New PHP $version release\", \"tags\": [], \"attributes\": {}, \"origin\": null, \"type\": null, \"timeout\": 691200, \"rawData\": null, \"customer\": null}"; done
  #+END_SRC
* TODO Add .s6-svscan/finish and .s6-svscan/crash to webservices
  SCHEDULED: <2020-03-23 Mon>
#+begin_example
  root@web36 ~ # docker logs apache2-php53-hardened
  [Wed Mar 18 05:15:18.007847 2020] [mpm_prefork:notice] [pid 24] AH00163: Apache/2.4.41 (Unix) mpm-itk/2.4.7-04 PHP/5.3.29 configured -- resuming normal operations
  [Wed Mar 18 05:15:18.007892 2020] [mpm_prefork:info] [pid 24] AH00164: Server built: Aug  9 2019 13:36:47
  [Wed Mar 18 05:15:18.007905 2020] [core:notice] [pid 24] AH00094: Command line: '/nix/store/xm89nf0qg88c7l2yxxnpagl5pib8qfrc-apache-httpd-2.4.41/bin/httpd -D FOREGROUND -d /nix/store/gncm5v57wlq48v5r1h49yxxfq48wv9nq-apache2-rootfs-php53/etc/httpd'
  [Wed Mar 18 14:24:52.114603 2020] [mpm_prefork:notice] [pid 24] AH00171: Graceful restart requested, doing restart
  [Wed Mar 18 14:24:52.360462 2020] [mpm_prefork:notice] [pid 24] AH00163: Apache/2.4.41 (Unix) mpm-itk/2.4.7-04 PHP/5.3.29 configured -- resuming normal operations
  [Wed Mar 18 14:24:52.360479 2020] [mpm_prefork:info] [pid 24] AH00164: Server built: Aug  9 2019 13:36:47
  [Wed Mar 18 14:24:52.360485 2020] [core:notice] [pid 24] AH00094: Command line: '/nix/store/xm89nf0qg88c7l2yxxnpagl5pib8qfrc-apache-httpd-2.4.41/bin/httpd -D FOREGROUND -d /nix/store/gncm5v57wlq48v5r1h49yxxfq48wv9nq-apache2-rootfs-php53/etc/httpd'
  [Sun Mar 22 04:47:12.442742 2020] [reqtimeout:info] [pid 32692] [client 127.0.0.1:57438] AH01382: Request header read timeout
  s6-svscan: warning: unable to exec finish script .s6-svscan/finish: Permission denied
  s6-svscan: warning: executing into .s6-svscan/crash
  s6-svscan: fatal: unable to exec .s6-svscan/crash: No such file or directory
#+end_example
* TODO fileserver test.nix [[https://www.youtube.com/results?search_query=rsocket][rsocket - YouTube]]
  SCHEDULED: <2020-03-30 Mon>
* TODO Подключение кабеля IPMI на серверах https://cerberus.intr/index.php/profiles/ticket/AQ-84438-978/conversation/read_all
  SCHEDULED: <2020-03-29 Sun>
   - [[/home/oleg/src/nixpkgs-firefox-esr-52/pkgs/applications/networking/browsers/firefox/packages.nix][firefox]]
   - [[/home/oleg/src/nixpkgs-firefox-esr-52/pkgs/development/compilers/adoptopenjdk-icedtea-web/default.nix][icedtea]]
   - [[/home/oleg/src/nixpkgs-firefox-esr-52/jdk.nix][jdk]]
* TODO Олег Пыхалов (pyhalov) opened !2 *Jenkinsfile: Add HOSTNAME parameter.* in office / ssl-certificates
  SCHEDULED: <2020-04-05 Sun>
https://gitlab.intr/office/ssl-certificates/-/merge_requests/2
16:36
Оно работает, но т.к. пароль добавлен через credentials'ы jenkins'а, то при удалении хомяка работать перестанет :b
16:37
А примеров с curl'ом я не вижу для генерации именно строки секрета, короче на потом.
16:37
Ну, мержить сейчас можно, не ломает ничего.
16:38
И еще надо будет job'ы удалять сразу, чтобы не палить серты :b

* TODO Add note about NIX CHANNEL
  SCHEDULED: <2020-03-31 Tue>

* TODO when jenkins deploy to swarm and commit has't changed will be the unstash error
  SCHEDULED: <2020-04-26 Sun>
Олег Пыхалов (pyhalov at majordomo.ru)￼  14:38
Это ок? Не может stash. https://jenkins.intr/job/monitoring/job/kapacitor/job/master/2/console
￼
14:39
если коммит не изменился, там всегда фейл

* TODO Gluster offline bricks found on dh2-mr
  SCHEDULED: <2020-05-18 Mon>
На dh2-mr нет бриков текущего гластера, но есть брики нового
(тестового). В общем конкретно на dh2-mr не обращать внимания до тех
пор, пока не сообщим о вводе нового гластера.

** [[https://habr.com/ru/company/flant/blog/503712/][Состояние и производительность решений для постоянного хранения данных в Kubernetes]]

* TODO Add Bash script for git clone
  SCHEDULED: <2020-04-05 Sun>
: (f() { xterm -e "set -ex; cd $HOME/archive/src; git clone $1"; }; f "https://github.com/domtronn/all-the-icons.el")

* TODO jenkins disable host verification ("Host Key Verification Strategy")
  SCHEDULED: <2020-04-07 Tue>

* TODO postfix staff
  SCHEDULED: <2020-04-08 Wed>
#+begin_example
  Apr  7 17:18:19 smtp-staff postfix/smtpd[1467]: 59B7131405B4: client=dh2-mr.intr[172.16.103.156]
  Apr  7 17:18:19 smtp-staff postfix/cleanup[1470]: 59B7131405B4: message-id=<cbb33f72f0b719bbbd1ffef794ff8984@mail-manager.intr>
  Apr  7 17:18:19 smtp-staff opendkim[9834]: 59B7131405B4: DKIM-Signature field added (s=dkim, d=majordomo.ru)
  Apr  7 17:18:19 smtp-staff postfix/smtpd[9269]: connect from dh1-mr.intr[172.16.103.155]
  Apr  7 17:18:19 smtp-staff postfix/smtpd[9269]: 6141A31405E0: client=dh1-mr.intr[172.16.103.155]
  Apr  7 17:18:19 smtp-staff postfix/cleanup[9272]: 6141A31405E0: message-id=<aabef4654036414e257549a0a18f91ee@mail-manager.intr>
  Apr  7 17:18:19 smtp-staff opendkim[9834]: 6141A31405E0: DKIM-Signature field added (s=dkim, d=majordomo.ru)
  Apr  7 17:18:19 smtp-staff postfix/qmgr[2976]: 59B7131405B4: from=<noreply@majordomo.ru>, size=15097, nrcpt=2 (queue active)
  Apr  7 17:18:19 smtp-staff postfix/smtpd[1467]: disconnect from dh2-mr.intr[172.16.103.156] ehlo=1 mail=1 rcpt=2 data=1 quit=1 commands=6
  Apr  7 17:18:19 smtp-staff postfix/qmgr[2976]: 6141A31405E0: from=<noreply@majordomo.ru>, size=13367, nrcpt=2 (queue active)
  Apr  7 17:18:19 smtp-staff postfix/smtpd[9269]: disconnect from dh1-mr.intr[172.16.103.155] ehlo=1 mail=1 rcpt=2 data=1 quit=1 commands=6
  Apr  7 17:18:19 smtp-staff postfix-mailout/smtp[448]: 226823160AB1: to=<alumos@mail.ru>, relay=mxs.mail.ru[94.100.180.31]:25, delay=0.62, delays=0.11/0/0.05/0.45, dsn=2.0.0, status=sent (250 OK id=1jLp3T-0008U1-BR)
  Apr  7 17:18:19 smtp-staff postfix-mailout/qmgr[5781]: 226823160AB1: removed
  Apr  7 17:18:19 smtp-staff postfix/smtp[9265]: 6141A31405E0: to=<turm@turm2rm.ru>, relay=mmxs.majordomo.ru[78.108.80.147]:25, delay=0.41, delays=0.09/0.02/0.07/0.22, dsn=2.0.0, status=sent (250 OK id=1jLp3T-0000w6-Iq)
  Apr  7 17:18:19 smtp-staff postfix/smtp[1471]: 6141A31405E0: to=<turm@mail.ru>, relay=mxs.mail.ru[94.100.180.31]:25, delay=0.59, delays=0.09/0.02/0.11/0.37, dsn=2.0.0, status=sent (250 OK id=1jLp3T-000AKw-Kx)
  Apr  7 17:18:19 smtp-staff postfix/smtp[9266]: 59B7131405B4: to=<12volt.kr@mail.ru>, relay=mxs.mail.ru[94.100.180.31]:25, delay=0.62, delays=0.11/0.03/0.11/0.38, dsn=2.0.0, status=sent (250 OK id=1jLp3T-0006I1-M0)
  Apr  7 17:18:19 smtp-staff postfix/smtp[9266]: 59B7131405B4: to=<art6.krasnodar@mail.ru>, relay=mxs.mail.ru[94.100.180.31]:25, delay=0.62, delays=0.11/0.03/0.11/0.38, dsn=2.0.0, status=sent (250 OK id=1jLp3T-0006I1-M0)
  Apr  7 17:18:19 smtp-staff postfix/qmgr[2976]: 6141A31405E0: removed
  Apr  7 17:18:20 smtp-staff postfix/qmgr[2976]: 59B7131405B4: removed
#+end_example

* TODO https://jenkins.intr/job/ci/job/bfg/job/master/16/console
  SCHEDULED: <2020-04-16 Thu>
  https://jenkins.intr/job/webservices/job/nixoverlay/job/master/46/console

* TODO https://code.getnoc.com/noc/noc
  SCHEDULED: <2020-04-19 Sun>
  or use [[/home/oleg/src/work/graphviz/]]

* TODO https://gitlab.intr/_ci/maintenance-github/-/blob/master/projects.tf#L14
  SCHEDULED: <2020-04-17 Fri>
rename resource

* TODO billing2
  SCHEDULED: <2020-04-20 Mon>

изначально меня интересовало как определить какой способ установки делает perl скрипт
16:06 ты говоришь если arhive.intr не доступен одна фигня, если доступен другая
16:06 как определить какая фигня для конкретной vm12345 была выбрана
16:07 вот я и хочу исключить arhive.intr чтобы не было этого выбора


16:07
или сделать его fallback

16:08
my $checkimage = $vds->checkimage;
16:08
if ( $checkimage eq 0 ) {
                                       $vds->getimage ;
                                       $vds->do_vol_from_image ;
                               }
16:09
sub checkimage {
       my $self = shift ;
       system(sprintf("rsync --list-only rsync://archive.intr/images/jenkins-production/%s-%s.qcow2",  $self->{var}->{disk}->{template} , $self->{var}->{caps}->{disk}));
       if ( $? >>8 == 0 ) {
               print "Is available \n" ;
               return 0 ;
       }
       else {
               return 1 ;
       }
}
16:12
если будет локально, то рсинк на какой нить ls заменить и все

* TODO Delete nixpkgs badge in https://github.com/mjuh projects
  SCHEDULED: <2020-04-30 Thu>

* TODO Jenkins job Chef Workstation fix knife
https://jenkins.intr/job/ci/job/chef-workstation/job/master/5/console

* TODO Add to Redmine task to allow shared hosting users select only NGINX without proxy
  SCHEDULED: <2020-04-30 Thu>

* TODO Delete NGINX config
  SCHEDULED: <2020-05-01 Fri>
  [[/ssh:web28.intr|sudo:root@web28.intr:/etc/nginx/sites-available/598c3a79bfae8f41261b26b1.conf]]
  [[https://cerberus.intr/index.php/profiles/ticket/FS-75156-842/message/14885050]]

* TODO #YW-56173-324 У перенесенных аккаунтов HMS меняется владелец логов - Cerberus Helpdesk :: Majordomo.ru mail
  SCHEDULED: <2020-04-30 Thu>
[[file:~/majordomo/hms/taskexecutor/src/python/taskexecutor/resprocessor.py::os.makedirs(os.path.join(self.resource.homeDir,%20"logs"),%20mode=0o755,%20exist_ok=True)]]
[[file:~/majordomo/hms/taskexecutor/src/python/taskexecutor/sysservice.py::os.chown(home_dir,%20uid,%20uid)]]

* TODO http-fileserver
  SCHEDULED: <2020-04-30 Thu>
#+begin_example
  я чистый gz не юзал
  ```gzip -c .emacs > emacs.gz
  $(nix-build '<nixpkgs>' --no-out-link -A libarchive)/bin/bsdtar -xf emacs.gz```
  `bsdtar: Error opening archive: Unrecognized archive format`
  Сложна.
  bsdtar наверное для tar
  :kekw:
  ```$(nix-build '<nixpkgs>' --no-out-link -A libarchive)/bin/bsdcat emacs.gz```
  :aw_yeah:
  ```oleg@guixsd ~$ file emacs.gz 
  emacs.gz: gzip compressed data, was ".emacs", last modified: Wed Apr 29 14:04:10 2020, from Unix, original size 7706```
  ```oleg@guixsd ~$ file --mime emacs.gz 
  emacs.gz: application/x-gzip; charset=binary```
  ```
  3 matches for "format" in buffer: unarc.lua
       48:function unarc(uid, dst_dir, arc_len, format)
       66:  if format == 'application/x-rar-compressed' then
       77:  elseif format == 'application/x-7z-compressed' then
  [edit] ```3 matches for "format" in buffer: unarc.lua
       48:function unarc(uid, dst_dir, arc_len, format)
       66:  if format == 'application/x-rar-compressed' then
       77:  elseif format == 'application/x-7z-compressed' then```
  (Old message: ```
  3 matches for "format" in buffer: unarc.lua
       48:function unarc(uid, dst_dir, arc_len, format)
       66:  if format == 'application/x-rar-compressed' then
       77:  elseif format == 'application/x-7z-compressed' then)
  ```  else
      args = {'s6-setuidgid', uid..':'..uid,
              'foreground',
              ' redirfd', ' -w', ' 2', ' '..stderr_file,
              ' bsdtar', ' -C', ' '..dst_dir, ' -xf', ' -',
              '',
              'redirfd', '-w', '1', exitcode_file, 'importas', '?', '?', 's6-echo', '${?}'}
    end```
  Эй, ну почти сделали же :b
  fallocate, воу, а я dd юзал
  ```
      static contentTypesForArchiveUpload() {
          return [
              {name: 'application/x-tar', extensions: ['.tar']},
              {name: 'application/x-compressed', extensions: ['.tar.gz', '.tgz']},
              {name: 'application/x-rar-compressed', extensions: ['.rar']},
              {name: 'application/x-zip-compressed', extensions: ['.zip']},
              {name: 'application/x-7z-compressed', extensions: ['.7z']}
          ]
      }```
  наверное не сложно пропустить
#+end_example

* TODO Clean up src and archive/src
  SCHEDULED: <2020-05-03 Sun>

- [ ] hello-terraform
- [ ] runc
- [ ] src/erza
- [ ] src/docker-tftp move to src/docker-wigust
- [ ] Move git repositories out of archive/src/tmp

* TODO Stray
  SCHEDULED: <2020-05-03 Sun>
warning: stray .go files: ./gnu/packages/ham-radio.go ./gnu/packages/sdr.go

* TODO meta slash
  SCHEDULED: <2020-05-09 Sat>
    (define-key map (kbd "M-/") 'vterm-send-meta-sl)

* TODO mode-line show zombies count
  SCHEDULED: <2020-05-09 Sat>
: ps axo pid=,stat= | awk '$2~/^Z/ { print $1 }'

* TODO vnc
  SCHEDULED: <2020-05-12 Tue>
- good 5f97103337eabadd95f913eb9300225b0c2cad2b
- Use package-version instead of %tigervnc-VARIABLES

* TODO Add projectile-known-projects to wi-project-ivy
  SCHEDULED: <2020-05-12 Tue>

* TODO Add exec -a "SERVICE_NAME-java" to HMS projects
  SCHEDULED: <2020-06-01 Mon>

* TODO StumpWM update mode-line after font change
  SCHEDULED: <2020-05-17 Sun>
#+begin_quote
[14:51] <#stumpwm:mood> Do you enable your mode line before setting the font?
[14:52] <#stumpwm:boeg> yes
[14:52] <#stumpwm:boeg> should i swithc that?
[14:52] <#stumpwm:boeg> swithc*
[14:52] <#stumpwm:boeg> switch*
[14:52] <#stumpwm:mood> Ah. Then it's created with the old font, setting the height, and won't update until the next redraw
[14:52] <#stumpwm:mood> So yes
[14:52] <#stumpwm:boeg> alright
[14:52] <#stumpwm:boeg> yes, seems to work
[14:53] <#stumpwm:mood> Perhaps we could make set-font fix that automatically
#+end_quote

* TODO Fix ci-chef-workstation jenkins job
  SCHEDULED: <2020-05-18 Mon>

* TODO TRAMP
  SCHEDULED: <2020-05-17 Sun>
  (find-file "/ssh:web33.intr|sudo:web33.intr|docker:apache2-php73-unsafe:")

* TODO YouTube
  SCHEDULED: <2020-05-17 Sun>

  - UC2eYFnH61tmytImy1mTYvhA :: Luke Smith
  - UC4RssVemaZlrfdWbp1Wx :: Стримы Тангара
  - UCVls1GmFKf6WlTraIb_IaJg :: DistroTube
  - UCK-d8Z08ElRz0zgKiAla5fg :: Tangar streams

* TODO reevefresh
#+begin_example
  2020-05-17T16:41:30.926446285Z TWITCH_LIVE: tsoding
  2020-05-17T16:41:30.926448830Z TWITCH_LIVE: rwxrob
  2020-05-17T16:41:30.926451435Z Online users: tsoding,rwxrob
  2020-05-17T16:41:30.926454060Z 
  2020-05-17T16:41:30.926482824Z Traceback (most recent call last):
  2020-05-17T16:41:30.926487352Z   File "/bin/reevefresh", line 42, in main
  2020-05-17T16:41:30.926490378Z     if twitch.user(user).is_live:
  2020-05-17T16:41:30.926493123Z   File "/usr/local/lib/python3.7/site-packages/twitch/helix/helix.py", line 46, in user
  2020-05-17T16:41:30.926496049Z     return self.users(user)[0]
  2020-05-17T16:41:30.926498674Z   File "/usr/local/lib/python3.7/site-packages/twitch/helix/helix.py", line 43, in users
  2020-05-17T16:41:30.926503403Z     return helix.Users(self.api, *args)
  2020-05-17T16:41:30.926506218Z   File "/usr/local/lib/python3.7/site-packages/twitch/helix/resources/users.py", line 49, in __init__
  2020-05-17T16:41:30.926509123Z     for data in self._api.get(self._path, params=params, ignore_cache=True)['data']:
  2020-05-17T16:41:30.926511858Z   File "/usr/local/lib/python3.7/site-packages/twitch/api.py", line 111, in get
  2020-05-17T16:41:30.926514745Z     return self.request('GET', path, ignore_cache, params=params, headers=self._headers(headers), **kwargs)
  2020-05-17T16:41:30.926517550Z   File "/usr/local/lib/python3.7/site-packages/twitch/api.py", line 100, in request
  2020-05-17T16:41:30.926520385Z     response.raise_for_status()
  2020-05-17T16:41:30.926523020Z   File "/usr/local/lib/python3.7/site-packages/requests/models.py", line 941, in raise_for_status
  2020-05-17T16:41:30.926525826Z     raise HTTPError(http_error_msg, response=self)
  2020-05-17T16:41:30.926530805Z requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: https://api.twitch.tv/helix/users?login=arhont_tv
  2020-05-17T16:41:30.926533791Z 
  2020-05-17T16:41:30.926536355Z During handling of the above exception, another exception occurred:
  2020-05-17T16:41:30.926539121Z 
  2020-05-17T16:41:30.926541725Z Traceback (most recent call last):
  2020-05-17T16:41:30.926544410Z   File "/bin/reevefresh", line 61, in <module>
  2020-05-17T16:41:30.926547586Z     main()
  2020-05-17T16:41:30.926550271Z   File "/bin/reevefresh", line 52, in main
  2020-05-17T16:41:30.926553017Z     except error.HTTPError as exception:
  2020-05-17T16:41:30.926555682Z NameError: name 'error' is not defined
#+end_example

* TODO nix in guix
  SCHEDULED: <2020-05-23 Sat>
#+begin_example
  <kamil_> Anyone, do you have an idea why does calling the bash binary fails with the error message "while setting up the build enviroment: executing '/gnu/store/*-bash-minimal-5.0.16/bin/bash': No such file or directory" when trying to build a Nix derivation? I've configured Nix as per the example in the Guix manual.
  --> ecbrown (~user@fsf/member/ecbrown) has joined #guix
  --> TZander (~zander@kde/zander) has joined #guix
  <-- ArneBab (~quassel@freenet/developer/arnebab) has quit (Remote host closed the connection)
  <-- jonsger (~Icedove@92.117.225.134) has quit (Ping timeout: 265 seconds)
  --> ArneBab (~quassel@p200300F44F1057BEB3164B221AB514CE.dip0.t-ipconnect.de) has joined #guix
  <-- ArneBab (~quassel@p200300F44F1057BEB3164B221AB514CE.dip0.t-ipconnect.de) has quit (Changing host)
  --> ArneBab (~quassel@freenet/developer/arnebab) has joined #guix
  <rekado> kamil_: does that file reference a loader at a location you don’t have?
  <-- ArneBab (~quassel@freenet/developer/arnebab) has quit (Quit: No Ping reply in 180 seconds.)
  <civodul> rekado: re https://gitlab.inria.fr/guix-hpc/website/-/blob/master/drafts/pack-fakechroot.md do you know the situation of national academic clusters in Germany?
  --> ArneBab (~quassel@p200300f44f1057beb3164b221ab514ce.dip0.t-ipconnect.de) has joined #guix
  <-- ArneBab (~quassel@p200300f44f1057beb3164b221ab514ce.dip0.t-ipconnect.de) has quit (Changing host)
  --> ArneBab (~quassel@freenet/developer/arnebab) has joined #guix
  --> mothacehe (~user@lfbn-ann-1-238-30.w86-200.abo.wanadoo.fr) has joined #guix
  <-- ArneBab (~quassel@freenet/developer/arnebab) has quit (Remote host closed the connection)
  --> ArneBab (~quassel@p200300F44F1057BEB3164B221AB514CE.dip0.t-ipconnect.de) has joined #guix
  <-- ArneBab (~quassel@p200300F44F1057BEB3164B221AB514CE.dip0.t-ipconnect.de) has quit (Changing host)
  --> ArneBab (~quassel@freenet/developer/arnebab) has joined #guix
  <kamil_> rekado, the path is valid and the requested file exists there
  <-- buffet (~buffet@vm-irc.spline.inf.fu-berlin.de) has left #guix ("Spline - https://spline.de")
  <-- iyzsong (~iyzsong@fsf/member/iyzsong) has quit (Quit: ZNC 1.7.1 - https://znc.in)
  --> iyzsong (~iyzsong@fsf/member/iyzsong) has joined #guix
  <mbakke> kamil_: try running $(guix build glibc)/bin/ldd on that file, are there any missing references?
  <-- vertigo_38 (~vertigo_3@178.165.128.28.wireless.dyn.drei.com) has quit (Ping timeout: 272 seconds)
  <rekado> civodul: I don’t know.  I only know about the two clusters at the Berlin Institute of Health and the MDC
  <rekado> they are both on CentOS 7 AFAIK
  <kamil_> mbakke, "-bash: /gnu/store/*-glibc-2.31-debug: Is a directory"
  <rekado> that trick won’t work because guix build glibc returns two values
  <mbakke> kamil_: oh, whoops... use /gnu/store/1y7g7kj3zxg2p90g692wybqh9b6gv7q2-glibc-2.31/bin/ldd
  <mbakke> would be neat if we could use guix build glibc:out, but that's not currently supported
  <civodul> i started working on it some time ago but there were annoyances
  <kamil_> mbakke, linux-vdso.so.1 (0x00007ffd629e1000), whilst 3 other *.so files point to something like this "=>".
  --> xd1le (~xd1le@unaffiliated/xd1le) has joined #guix
  <mbakke> only three?  is there a ld-linux-x86-64.so reference?
  <mbakke> kamil_: can you execute that bash outside of the nix store?  not sure if the Nix service should be using anything from /gnu/store at all
  <mbakke> perhaps wigust knows more :-)
  <kamil_> I wasn't clear enough, sorry. There are 4 references, only one--linux-vdso.so.1, is missing a reference; whilst the other 3--libdl.so.2, libc.so.6 and /gnu/store/*-glibc2.31/lib/ld-linux-x86-64.so.2--don't have missing references.
  <-- ArneBab (~quassel@freenet/developer/arnebab) has quit (Remote host closed the connection)
  --> vertigo_38 (~vertigo_3@141.244.112.111) has joined #guix
  <kamil_> mbakke, executing this bash file prints our an error: "bash: shopt: progcomp: invalid shell option name" and drops me into a new bash shell
  --> ArneBab (~quassel@freenet/developer/arnebab) has joined #guix
  <wigust> mbakke: well, when I installed there was no issue like this :b
  <mbakke> kamil_:  ok, that sounds normal
  <kamil_> mbakke, it should be noted that pressing arrow keys only prints symbols like this: ^[[C
  <mbakke> wigust: perhaps the recent Nix update broke it?  have you tried using it since 13c18af1d835db11f3f4cf34e65c7da706625a3f ?
  <-- andruSHA (~andruSHA@c83-252-29-60.bredband.comhem.se) has quit (Ping timeout: 240 seconds)
  --> andruSHA (~andruSHA@host-78-79-232-216.mobileonline.telia.com) has joined #guix
  <mbakke> kamil_: that's expected, bash-minimal does not include readline or many other things that your bashrc might expect
  <wigust> mbakke: no, I installed it on couple machines before the update and then I switched to nix-daemon installed by Nix itself
  <mbakke> right
  <mbakke> kamil_: can you file a bug report?
  -*- mbakke has to go
  <kamil_> mbakke, I would love to, but I still can't. I really wish there was a gitlab bug tracker for the less adventurous
  <-- roscoe_tw (~user@220-133-198-194.HINET-IP.hinet.net) has quit (Remote host closed the connection)
  <mbakke> kamil_: most bug trackers require an email address too, no? :)
  --> roscoe_tw (~user@220-133-198-194.HINET-IP.hinet.net) has joined #guix
#+end_example

* TODO CMS installers
  SCHEDULED: <2020-05-22 Fri>
  - [[https://github.com/discourse//blob/master/docs/INSTALL.md][discourse installer]]
  - https://beget.com/ru/manual/cms

* TODO Fix /workdir in MySQL Moodle
  SCHEDULED: <2020-05-22 Fri>

* TODO web35
#+begin_example
  pyhalov@majordomo.ru
  [Tech-list] web35 замена диска 02.01.2020
  WN-92146-968

  Диск Samsung SSD 860 PRO 256 S251NX0H812847P заменен на Samsung SSD 860
  PRO 256 S418NF0KA16142.  Старый промаркирован (коробка промаркирована
  также) как "bad web35" и убран в ЗИП.
  Во время первого нашего обращения сотрудник Мирана не мог найти нашего
  ЗИП хранилища.
  Перед заменой диска потребовалось отключить сервер из-за отсутствия
  изменений в индикации корзин (arcconf identify 1 device 0 1 и arcconf 
  identify 1 all).
  До замены диска:
  $ arcconf getconfig 1 ld
  Logical device number 1
      Logical device name                      : mysql
      Block Size of member drives              : 512 Bytes
      RAID level                               : 1
      Unique Identifier                        : ADB4E731
      Status of logical device                 : Degraded
      Size                                     : 244090 MB
      Parity space                             : 244100 MB
      Read-cache setting                       : Enabled
      Read-cache status                        : On
      Write-cache setting                      : Disabled
      Write-cache status                       : Off
      Partitioned                              : Yes
      Protected by Hot-Spare                   : No
      Bootable                                 : No
      Failed stripes                           : No
      Power settings                           : Disabled
      --------------------------------------------------------
      Logical device segment information
      --------------------------------------------------------
      Segment 0                                : Present 
  (Controller:1,Connector:0,Device:0) S251NX0H813096R
      Segment 1                                : Missing
  _______________________________________________
  Tech-list mailing list
  Tech-list@mailman.majordomo.ru
  http://mailman.majordomo.ru/mailman/listinfo/tech-list
#+end_example

* TODO obs is working on 8686922e68dfce2786722acad9593ad392297188 nixpkgs
  SCHEDULED: <2020-05-31 Sun>

* TODO web35 извлечен диск с s/n S251NX0H813096

* TODO iptables
  SCHEDULED: <2020-06-01 Mon>
#+begin_quote
root@web29 ~ # sudo -u u226109 -i
u226109@web29:~$ ping gitlab.intr
PING gitlab.intr (172.16.103.139) 56(84) bytes of data.
64 bytes from gitlab.intr (172.16.103.139): icmp_seq=1 ttl=64 time=0.167 ms
^C
--- gitlab.intr ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.167/0.167/0.167/0.000 ms
u226109@web29:~$ 
-A OUTPUT -d 172.16.0.0/16 -p icmp -m owner --uid-owner 2000-65535 -j DROP
-A OUTPUT -p tcp -m tcp --dport 53 -m owner --uid-owner 2000-65535 -j ACCEPT
-A OUTPUT -p udp -m udp --dport 53 -m owner --uid-owner 2000-65535 -j ACCEPT
root@web29 ~ # id u226109
uid=83859(u226109) gid=83859(u226109) groups=83859(u226109),1999(hosting_accounts)
))
поправишь по всем вебам?)
я ничего не сделал
я делаю iptables для вебов будущего
и взял правила с прода
и увидел, что мы блочим 172.16.0.0 для уидов 2000-65535
а уиды в проде уже перевалили за 83859
и как следствие им доступно 172.16.x.x
тем кто случайно выше 65535
--uid-owner 2000-65535 надо поменять на  --uid-owner  2000-524280 к примеру
во всех /etc/iptables*
на всех web*
ну и потом iptables-restore сделать
не я не буду сейчас
zdetovetskiy is away: "away"
потерпит
надо сначала найти uid максимальный в ядре
после сверить что то которое у тебя в никсе такой же uid
после в миране чтобы стояли возле кнопки на всякий
#+end_quote
